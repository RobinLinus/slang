"use strict";window.Slang=window.Slang||{},window.Slang.mathslang={},window.Slang.mathslang.compare=function(n,t,e){return Slang.logicslang.compare(n,t,this._compare,e)},window.Slang.mathslang.extractUnit=function(n){return Slang._mathslang.impl.extractUnit(n)},window.Slang.mathslang._compare=function(n,t,e){t+="",n+="";if(t=t.trim(),n=n.trim(),0===n.indexOf("#")){var r=n.substr(1,n.indexOf(" ")-1);switch(n=n.substr(n.indexOf(" ")+1),r){case"equals":return Slang._mathslang.impl.match(n,t,e);case"identic":return Slang._mathslang.impl.matchSyntax(n,t);case"approx":var u=n.split("#epsilon");return Slang._mathslang.impl.matchApprox(u[0],t,u[1],e);case"lt":return Number.parseFloat(t)<Number.parseFloat(n);case"leq":return Number.parseFloat(t)<=Number.parseFloat(n);case"gt":return Number.parseFloat(t)>Number.parseFloat(n);case"geq":return Number.parseFloat(t)>=Number.parseFloat(n);default:return n===t}}},window.Slang=window.Slang||{},window.Slang._mathslang=window.Slang._mathslang||{},window.Slang._mathslang.imaginary=function(){function n(n){var t={};return Object.keys(n).sort(function(n,t){return n.charCodeAt(0)-t.charCodeAt(0)}).forEach(function(e){t[e]=n[e]}),t}function t(n,t){Object.keys(t).forEach(function(e){n[e]?n[e]+=t[e]:n[e]=t[e],n[e]||delete n[e]})}function e(n){Object.keys(n).forEach(function(t){delete n[t]})}function r(n,t){Object.keys(n).forEach(function(e){t?n[e]*=t:delete n[e]})}function u(n,t){return JSON.stringify(n)==JSON.stringify(t)}function s(n){return 0==Object.keys(n).length}function a(n,t){for(var e=Object.keys(n),r=Object.keys(t),u=Math.min(e.length,r.length),s=0;u>s;s++){if(e[s]<r[s])return-1;if(e[s]>r[s])return 1}var a=e.length-r.length;if(a)return a;for(var s=0;u>s;s++)if(a=n[e[s]]-t[r[s]])return a;return 0}function o(n,t){for(var e=Math.min(n.length,t.length),r=0;e>r;r++){if(n[r]<t[r])return-1;if(n[r]>t[r])return 1}return n.length-t.length}function i(n){return n.split("").sort(function(n,t){return n.charCodeAt(0)-t.charCodeAt(0)}).reduce(function(n,t){return n+t},"")}function c(n){for(var t={},e=0;e<n.length;e++){var r=n[e];t[r]?t[r]++:t[r]=1}return t}function f(n){for(var t=1,e=0;e<n.length;e++)t*=n.charCodeAt(0);return t}function l(n){return Object.keys(n).length}function g(n){return Object.keys(n).reduce(function(t,e){return t[e]=n[e],t},{})}function p(n){return Object.keys(n).reduce(function(t,e){var r=n[e];return t+(1==r?e:e+"^"+r)},"")}return{sort:n,insert:t,clear:e,pow:r,equals:u,empty:s,sortFunc:a,strSortFunc:o,strSort:i,strParse:c,strValue:f,len:l,clone:g,string:p}}(),window.Slang=window.Slang||{},window.Slang._mathslang=window.Slang._mathslang||{},window.Slang._mathslang.impl=function(){function n(){return Slang._mathslang.lexical}function t(){return Slang._mathslang.syntax}function e(){return Slang._mathslang.semantix}function r(r,u,s){try{return s&&(r=n().replace_units(r,s),u=n().replace_units(u,s)),n().empty(r)||n().empty(u)?!1:(r=t().present(r),u=t().present(u),t().string(r)==t().string(u)?(console.log("syntax equality: "+t().string(r)+" = "+t().string(u)),!0):(r=e().represent(r),u=e().represent(u),r.string()==u.string()?(console.log("semantix equality: "+r.string()+" = "+u.string()),!0):r.calc()==u.calc()?(console.log("constant equality: "+r.string()+" = "+u.string()),!0):(r=r.simplify(3),u=u.simplify(3),r.string()==u.string()?(console.log("simplify equality: "+r.string()+" = "+u.string()),!0):(console.log("no semantix equality: "+r.string()+" = "+u.string()),!1))))}catch(a){return!1}}function u(e,r,u){try{return u&&(e=n().replace_units(e,u),r=n().replace_units(r,u)),n().empty(e)||n().empty(r)?!1:(e=t().present(e),r=t().present(r),t().string(e)==t().string(r)?(console.log("syntax equality: "+t().string(e)+" = "+t().string(r)),!0):(console.log("no syntax equality: "+t().string(e)+" = "+t().string(r)),!1))}catch(s){return!1}}function s(t,r,u,s){try{if("number"==typeof t&&(t=""+t),"number"==typeof r&&(r=""+r),"string"==typeof u&&(u=parseFloat(u)),s&&(t=n().replace_units(t,s),r=n().replace_units(r,s)),n().empty(t)||n().empty(r))return!1;t=e().present(t),r=e().present(r);var a=e().clone(t),o=e().clone(r);return e().free_const(a),e().free_const(o),a=a.simplify(3),o=o.simplify(3),a.string()!=o.string()?!1:(e().free_imag(t),e().free_imag(r),t=t.simplify(2),r=r.simplify(2),t=t.calc(),r=r.calc(),isNaN(t)||isNaN(r)?!1:Math.abs(t-r)<=u+2.31e-16?(console.log("approx equality: "+t+" = "+r+" (epsilon = "+u+")"),!0):!1)}catch(u){return!1}}function a(t,r){function u(n,t,e){return n.substr(0,t)+e+n.substr(t+e.length)}r&&(t=n().replace_units(t,r)),t=e().present(t),t=t.simplify(3),e().free_const(t),t=e().string_imag(t);for(var s=0;s<t.length;++s)if(s>0&&"^"==t[s-1]&&"-"==t[s]){for(var a=0;" "==t[s-2-a];)++a;if(")"==t[s-2-a]){for(var o=1,i=1;i>0&&s-2-a-o>=0;){var c=t[s-2-a-o];i+="("==c?-1:")"==c?1:0,++o}for(;o>=0;)--o}else t=u(t,s-0,"^"),t=u(t,s-1,t[s-2]),t=u(t,s-2,"/")}return t=t.replace(/1/g,"")}return{match:r,matchSyntax:u,matchApprox:s,extractUnit:a}}(),window.Slang=window.Slang||{},window.Slang._mathslang=window.Slang._mathslang||{},window.Slang._mathslang.lexical=function(){function n(n,t){this.flag=n,this.code=t,this.inv=!1}function t(t){t=o(t);for(var e=[],r=s(t).split("");r.length>0;){var u=0,g="";if(c.test(r[0])){do r.shift();while(c.test(r[0]))}else if(f[0].test(r[0])){r.shift(),g="",u=i.L;for(var p=1,h="";p>0;){if(g+=h,0==r.length)throw")";h=r.shift(),p+=f[0].test(h)?1:f[1].test(h)?-1:0}e.push(new n(u,g))}else{for(;u<l.length;){var m=l[u];if(m.test(r[0]))do g=g.concat(r.shift());while(m.plu&&m.test(r[0]));g.length>0?(e.push(new n(u,g)),u=l.length):u++}if(0==g.length)throw r.shift()}}return a(e)}function e(n){for(var t=0;t<n.length;t++)if(!c.test(n[t]))return!1;return!0}function r(n,t){function e(n,t,e){return n.substr(0,t)+e+n.substr(t+e.length)}var r=!0,u=!0;t.split(" ").forEach(function(t){switch(t){case"weight":n=n.replace(/ton/g,"(�1000000g)"),u&&(n=n.replace(/t/g,"(�1000000g)")),n=n.replace(/Kg/g,"(�1000g)"),n=n.replace(/kg/g,"(�1000g)"),n=n.replace(/mg/g,"(�0.001g)");break;case"distance":n=n.replace(/Km/g,"(� 1000m)"),n=n.replace(/km/g,"(� 1000m)"),n=n.replace(/dm/g,"(� 0.100m)"),n=n.replace(/cm/g,"(� 0.010m)"),n=n.replace(/mm/g,"(� 0.001m)"),n=n.replace(/min/g,"(� 60s)"),n=n.replace(/m/g,"(� m)"),r=!1;break;case"time":n=n.replace(/min/g,"(� 60s)"),r&&(n=n.replace(/m/g,"(� 60s)")),n=n.replace(/h/g,"(� 3600s)"),n=n.replace(/s/g,"(� s)"),u=!1;break;default:throw"mathslang does not support unit `"+t+"'"}});for(var s=0;s<n.length;++s)if("�"==n[s]){if(s&&"("!=n[s-1])throw n[s-1]+"� instead of (�";var a=2;do{for(;" "==n[s-a];)++a;if(s>=a&&")"==n[s-a]){for(var o=1;o>0&&s>a;){var i=n[s-++a];o+=")"==i?1:"("==i?-1:0}++a}for(;" "==n[s-a];)++a;for(;s>=a&&/^[0-9a-zA-Z]$/.test(n[s-a]);)++a;for(;" "==n[s-a];)++a}while(s>=a&&")"==n[s-a]);if("/"==n[s-a]){for(var c=0;a>c+2;++c)n=e(n,s-c,n[s-c-2]);n=e(n,s-a+1," "),n=e(n,s-a+2,"(")}}return n.replace(/\�/g,"")}function u(n,t){this.exp=t,this.plu=n,this.test=function(n){return this.exp.test(n)}}function s(n){return n=n.replace(/�/g,"^2"),n=n.replace(/�/g,"^3"),n=n.replace(/\u00B2/g,"^2"),n=n.replace(/\u00B3/g,"^3"),n=n.replace(/,/g,".")}function a(n){var t=[],e=!1;for(var r in n){if(n[r].flag==i.O)switch(n[r].code){case"-":n[r].inv=!n[r].inv;case"+":break;case"/":e=!0;case"*":continue;default:throw"operator `"+n[r].code+"' has not been implemented."}else if(n[r].flag==i.E){if(0==t.length)throw"radix ahead `"+n[r].code+"' is undefined.";var u=t.pop();if(u.flag==i.O)throw"radix is not allowed to be an `"+u.code+"' operator.";n[r].code=u.code,n[r].inv=u.inv}else e&&(n[r].inv=!(e=!1));t.push(n[r])}return t}function o(n){for(var t={"Sqrt(�)":"�^.5","sqrt(�)":"�^.5","root(�)":"�^.5","wurzel(�)":"�^.5","Wurzel(�)":"�^.5","R007(�)":"�^.5"},e=Object.keys(t),r=0;r<n.length;++r)for(var u=0;u<e.length;++u)for(var s=0;e[u][s]==n[r+s];)if(++s,"�"==e[u][s]){for(var a="",o=0,i="";(i=n[r+s+o])!=e[u][s+1];)a+=i,++o;n=n.substr(0,r)+"("+t[e[u]]+n.substr(r+s+o,n.length),n=n.replace("�","("+a+")")}return n}var i={O:0,E:1,X:2,N:3,L:7},c=new u(!0,/^\s$/),f=[new u(!1,/^\(|\[|\{$/),new u(!1,/^\)|\]|\}$/)],l=[new u(!1,/^\+|\-|\*|\/$/),new u(!1,/^\^$/),new u(!1,/^[a-zA-Z]$/),new u(!0,/^[0-9]|\,|\.$/)];return{FLAG:i,T:n,iter:t,empty:e,replace_units:r}}(),window.Slang=window.Slang||{},window.Slang._mathslang=window.Slang._mathslang||{},window.Slang._mathslang.semantix=function(){function n(n,t,e){this.fact=void 0!==n?n:1,this.imag=void 0!==t?t:{},this.sums=void 0!==e?e:[]}function t(n,t,e){this.offset=void 0!==n?n:0,this.queues=void 0!==t&&t.length?t:[],this.expont=void 0!==e?e:null}function e(){return Slang._mathslang.imaginary}function r(){return Slang._mathslang.syntax}function u(n){if("string"!=typeof n)throw"`Seman.present(string)' got `"+typeof n+"' instead of `string'";var t=r().present(n);return s(t)}function s(n){var e=new t;return n.forEach(function(n){var t=a(n);o(t)?e.offset+=t.fact:e.queues.push(t)}),e=i(e)}function a(r){var u=new n;return u.fact=r.fact?r.fact.reduce(function(n,t){return n*t},1):1,u.imag=e().strParse(r.imag),r.exps.forEach(function(e){var r=s(e.radix),a=s(e.power),o=r.expont;if(r.expont=a,o){var i=new t;r.expont=o,i.expont=a,i.queues.push(new n(1,{},[r])),r=i}u.sums.push(r)}),r.sums.forEach(function(n){var t=s(n);u.sums.push(t)}),u}function o(n){return 0==e().len(n.imag)&&0==n.sums.length}function i(n){var t=n.expont?n.expont.calc():NaN;return 0!=n.offset||1!=n.queues.length||1!=n.queues[0].fact||0!=n.queues[0].sums||isNaN(t)?n.queues.forEach(function(n){return n.sums.map(function(n){return i(n)})}):(e().pow(n.queues[0].imag,t),n.expont=null),0!=n.offset||1!=n.queues.length||n.expont||1!=n.queues[0].fact||0!=e().len(n.queues[0].imag)||1!=n.queues[0].sums.length?n:i(n.queues[0].sums[0])}function c(n){var t=n.offset+n.queues.reduce(function(n,t){return n+f(t)},0);return n.expont?Math.pow(t,c(n.expont)):t}function f(n){return Object.keys(n.imag).length>0?NaN:n.fact*n.sums.reduce(function(n,t){return n*c(t)},1)}function l(n){return n.expont?0==n.offset&&1==n.queues.length?!0:0!=n.offset&&0==n.queues.length:!1}function g(t,e){return new n(Math.pow(t.fact,e),Object.keys(t.imag).reduce(function(n,r){return n[r]=t.imag[r]*e,n},{}))}function p(n){return 0==n.offset&&null==n.expont&&n.queues.length?!n.queues.some(f):!1}function h(n){return n.fact*n.sums.reduce(function(n,t){return n*t.calc()},1)==1&&e().empty(n.imag)}function m(n){var t=n.expont?!0:!1;return n.queues.reduce(function(n,t){var e=t.string();return n+(t.fact<0?e:"+"+e)},(t?"(":"")+n.offset)+(t?")^("+n.expont.string()+")":"")}function w(n){return n.sums.reduce(function(n,t){return n+"("+t.string()+")"},""+n.fact+e().string(n.imag))}function d(n){var e=new t;return e.offset=n.offset,e.queues=n.queues.map(v),e.expont=n.expont?d(n.expont):null,e}function v(t){var r=new n;return r.fact=t.fact,r.imag=e().clone(t.imag),r.sums=t.sums.map(d),r}function x(n,t){do n=n.expand(),n=n.combine(),n=n.expow();while(--t>0);return n}function y(n){for(var t=0;t<n.queues.length;){var r=q(n.queues[t]);if(e().clear(n.queues[t].imag),n.queues[t].fact=1,n.queues[t].ident()){if(r.expont)throw"`expand': `s0.expont' must be `null'.";n.queues.splice(t,1),n.offset+=r.offset,n.queues=r.queues.concat(n.queues),t+=r.queues.length}else 1!=r.calc()&&n.queues[t].sums.push(r),t++}}function q(r){for(var u=new t(0,[new n(r.fact,e().clone(r.imag))]),s=0;s<r.sums.length;)y(r.sums[s]),null==r.sums[s].expont?(u=S(u,r.sums[s]),r.sums.splice(s,1)):s++;return u}function S(r,u){if(null!=r.expont)throw"`expansion': `s0.expont != null'";if(null!=u.expont)throw"`expansion': `s1.expont != null'";var s=r.offset*u.offset,a=r.queues.map(function(t){return new n(u.offset*t.fact,e().clone(t.imag),t.sums)}).concat(u.queues.map(function(t){return new n(r.offset*t.fact,e().clone(t.imag),t.sums)}));return r.queues.forEach(function(t){u.queues.forEach(function(r){var u={};e().insert(u,t.imag),e().insert(u,r.imag),a.push(new n(t.fact*r.fact,e().sort(u),t.sums.concat(r.sums)))})}),r=new t(s,a.filter(function(n){return 0!=n.fact}))}function b(n){var r=n.offset,u=[],s=void 0,a=n.expont;return a&&(a=b(n.expont)),n.queues.filter(function(n){var t=f(n);return isNaN(t)?!0:(r+=t,!1)}).map(function(n){return _(n),n}).sort(function(n,t){return-e().sortFunc(n.imag,t.imag)}).forEach(function(n){void 0!=s&&e().equals(s.imag,n.imag)&&0==s.sums.length&&0==n.sums.length?u[0].fact+=n.fact:(u.unshift(n),s=n)}),u=u.filter(function(n){return 0!=n.fact}),n=i(new t(r,u,a))}function _(n){var t,e,r,u=[];t=n.sums.reduce(function(n,t,e){t=t.combine(t);var r=t.expont;t.expont=null;var u=m(t);return t.expont=r,n[u]?n[u].push(e):n[u]=[e],n},new Object),e=Object.keys(t);for(var s=0;s<e.length;s++)r=t[e[s]],r.length>1&&(u=u.concat(k(n.sums,r)));u.sort(function(n,t){return t-n}).forEach(function(t){n.sums.splice(t,1)})}function k(e,r){if(r.length<2)throw"`combineE': "+r.length+"/2 indices";var u=[],s=new t,a=new t;for(a.offset=e[r[0]].offset,a.queues=e[r[0]].queues;r.length;){var o=e[r[0]].expont;o?o.expont?s.queues.push(new n(1,{},[o])):(s.offset+=o.offset,s.queues=s.queues.concat(o.queues)):s.offset++,u.push(r[0]),r.splice(0,1)}return a.expont=s,e.push(a),u}function N(e){e=E(e);var r=e.expont?e.expont.calc():NaN;if(isNaN(r))e.expont&&e.expont.expont;else{for(var u=[];r>1;){var s=new t;s.offset=e.offset,s.queues=e.queues.map(v),u.push(s),r--}e.expont=1==r?null:new t(r),u.length&&(u.unshift(e),e=new t,e.queues.push(new n(1,{},u)))}return e.queues.forEach(function(n){n.sums=n.sums.map(N)}),e=i(e)}function E(n){if(0==n.offset&&1==n.queues.length&&n.expont){for(var r=n.expont,u=n.queues[0],n=new t(0,[u]),s=0;s<u.sums.length;s++){var a=u.sums[s].expont,o=d(r);u.sums[s].expont=S(a,o)}var i=r.calc();isNaN(i)?(u.sums.push(new t(u.fact,u.imag,d(r))),u.fact=1,u.imag={}):(u.fact=Math.pow(u.fact,i),e().pow(u.imag,i))}return n}function O(n){n.queues.forEach(function(n){n.imag="",n.sums.forEach(function(n){O(n)})}),n.expont&&O(n.expont)}function F(n){n.offset=0,n.queues.forEach(function(n){n.fact=1,n.sums.forEach(function(n){F(n)})}),n.expont&&F(n.expont)}function A(n){for(var t="",e=0;e<n.queues.length;++e){var r=n.queues[e];t=Object.keys(r.imag).reduce(function(n,t){var e=r.imag[t];return n+(1==e?t:-1==e?"1/"+t:t+"^"+e)},t),r.sums.forEach(function(n){t+="("+A(n)+")"}),e+1<n.queues.length&&(t+=" + ")}return n.expont?t+"^"+A(n.expont):t}return n.prototype.calc=function(){return f(this)},n.prototype.ident=function(){return h(this)},n.prototype.string=function(){return w(this)},n.prototype.pow=function(n){return g(this,n)},t.prototype.calc=function(){return c(this)},t.prototype.expand=function(){return y(this),this},t.prototype.combine=function(){return b(this)},t.prototype.expow=function(){return N(this)},t.prototype.akinQ=function(){return l(this)},t.prototype.ident=function(){return p(this)},t.prototype.string=function(){return m(this)},t.prototype.simplify=function(n){return x(this,n)},{present:u,represent:s,clone:d,free_imag:O,free_const:F,simplify:x,string_imag:A}}(),window.Slang=window.Slang||{},window.Slang._mathslang=window.Slang._mathslang||{},window.Slang._mathslang.syntax=function(){function n(){this.fact=[],this.imag="",this.exps=[],this.sums=[]}function t(){this.radix=[],this.power=[]}function e(){return Slang._mathslang.lexical}function r(n){if("string"!=typeof n)throw"syntax.present(typeof s = "+typeof n+")";var t=e().iter(n),r=[];do{for(var s=!1;t.length>0&&t[0].flag==e().FLAG.O;)t.shift().inv&&(s=!s);var a=u(t);a&&(s&&a.fact.unshift(-1),r.push(a))}while(t.length>0);return c(r),r}function u(u){for(var i=new n;u.length>0;)switch(u[0].flag){case e().FLAG.N:var c=parseFloat(u[0].code);if(u.shift().inv){if(0==c)throw"`pluckQ' divided by 0.";c=1/c}i.fact.push(c);break;case e().FLAG.X:var f=u[0].code;if(u.shift().inv){var l=new t;l.radix.push(o(f)),l.power.push(a(-1)),i.exps.push(l)}else i.imag+=f;break;case e().FLAG.E:var l=new t;u[0].inv,l.radix=r(u.shift().code),l.power=s(u),i.exps.push(l);break;case e().FLAG.L:var g=r(u[0].code);if(u.shift().inv){var l=new t;l.radix=g,l.power.push(a(-1)),i.exps.push(l)}else i.sums.push(g);break;case e().FLAG.O:default:return h(i)?null:i}return h(i)?null:i}function s(n){if(!(n.length>0))throw"`pluckT' without any token.";switch(n[0].flag){case e().FLAG.N:return[a(n.shift().code)];case e().FLAG.X:return[o(n.shift().code)];case e().FLAG.E:var u=new t;if(n[0].inv)throw"`pluckT("+n[0].code+"..)' illegal `inv'";return u.radix=r(n.shift().code),u.power=s(n,!0),[i(u)];case e().FLAG.L:return r(n.shift().code);case e().FLAG.O:n.shift();var c=s(n);return c.forEach(function(n){n.fact.push(-1)}),c;default:throw"`pluckT' invalid `flag=?'."}}function a(t){var e=new n;return e.fact.push(t),e}function o(t){var e=new n;return"string"!=typeof t?(console.log("not a string"),e):(e.imag=t,e)}function i(t){var e=new n;return"E"!=typeof t?(console.log("not a E"),e):(e.exps.push(t),e)}function c(n){n.forEach(function(n){f(n)}),n.sort(function(n,t){return Slang._mathslang.imaginary.strSortFunc(n.imag,t.imag)})}function f(n){n.sums.forEach(function(n){c(n)}),n.fact.sort(function(n,t){return n-t}),n.imag=Slang._mathslang.imaginary.strSort(n.imag),n.exps.sort(function(n,t){return g(n)-g(t)}),n.sums.sort(function(n,t){return l(n)-l(t)})}function l(n){return n.reduce(function(n,t){return n+p(t)},0)}function g(n){return Math.pow(16536421.3572347+l(n.radix),l(n.power))}function p(n){return n.fact.reduce(function(n,t){return n*t},1)*Slang._mathslang.imaginary.strValue(n.imag)*n.exps.reduce(function(n,t){return n*g(t)},1)*n.sums.reduce(function(n,t){return n*l(t)},1)}function h(n){return 0==n.fact.length&&0==n.imag.length&&0==n.exps.length&&0==n.sums.length}function m(n){var t="";if(n.length){t+=w(n[0]);for(var e=1;e<n.length;e++){var r=n[e].fact.reduce(function(n,t){return n*t},1),u=w(n[e]);t+=0>r?u:"+"+u}}return t}function w(n){var t="";if(n.fact.length){t+=n.fact[0];for(var e=1;e<n.fact.length;e++)t+="*"+n.fact[e]}return t+=n.imag,t+=n.exps.reduce(function(n,t){return n+d(t)},""),t+=n.sums.reduce(function(n,t){return n+"("+m(t)+")"},"")}function d(n){return"("+m(n.radix)+")^("+m(n.power)+")"}return{Q:n,E:t,present:r,pluckQ:u,N2Q:a,X2Q:o,sort:c,emptyQ:h,string:m,stringQ:w}}();