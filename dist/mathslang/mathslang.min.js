"use strict";window.Slang=window.Slang||{},window.Slang.mathslang={},window.Slang.mathslang.compare=function(t,n,e){return Slang.logicslang.compare(t,n,this._compare,e)},window.Slang.mathslang.extractUnit=function(t){return Slang._mathslang.impl.extractUnit(t)},window.Slang.mathslang._compare=function(t,n,e){n+="",t+="";if(n=n.trim(),t=t.trim(),0===t.indexOf("#")){var r=t.substr(1,t.indexOf(" ")-1);switch(t=t.substr(t.indexOf(" ")+1),r){case"equals":return Slang._mathslang.impl.match(t,n,e);case"identic":return Slang._mathslang.impl.matchSyntax(t,n);case"approx":var s=t.split("#epsilon");return Slang._mathslang.impl.matchApprox(s[0],n,s[1],e);case"lt":return Number.parseFloat(n)<Number.parseFloat(t);case"leq":return Number.parseFloat(n)<=Number.parseFloat(t);case"gt":return Number.parseFloat(n)>Number.parseFloat(t);case"geq":return Number.parseFloat(n)>=Number.parseFloat(t);default:return t===n}}},window.Slang=window.Slang||{},window.Slang._mathslang=window.Slang._mathslang||{},window.Slang._mathslang.imaginary=function(){function t(t){var n={};return Object.keys(t).sort(function(t,n){return t.charCodeAt(0)-n.charCodeAt(0)}).forEach(function(e){n[e]=t[e]}),n}function n(t,n){Object.keys(n).forEach(function(e){t[e]?t[e]+=n[e]:t[e]=n[e],t[e]||delete t[e]})}function e(t){Object.keys(t).forEach(function(n){delete t[n]})}function r(t,n){Object.keys(t).forEach(function(e){n?t[e]*=n:delete t[e]})}function s(t,n){return JSON.stringify(t)==JSON.stringify(n)}function i(t){return 0==Object.keys(t).length}function a(t,n){for(var e=Object.keys(t),r=Object.keys(n),s=Math.min(e.length,r.length),i=0;s>i;i++){if(e[i]<r[i])return-1;if(e[i]>r[i])return 1}var a=e.length-r.length;if(a)return a;for(var i=0;s>i;i++)if(a=t[e[i]]-n[r[i]])return a;return 0}function u(t,n){for(var e=Math.min(t.length,n.length),r=0;e>r;r++){if(t[r]<n[r])return-1;if(t[r]>n[r])return 1}return t.length-n.length}function o(t){return t.split("").sort(function(t,n){return t.charCodeAt(0)-n.charCodeAt(0)}).reduce(function(t,n){return t+n},"")}function c(t){for(var n={},e=0;e<t.length;e++){var r=t[e];n[r]?n[r]++:n[r]=1}return n}function f(t){for(var n=1,e=0;e<t.length;e++)n*=t.charCodeAt(0);return n}function l(t){return Object.keys(t).length}function g(t){return Object.keys(t).reduce(function(n,e){return n[e]=t[e],n},{})}function h(t){return Object.keys(t).reduce(function(n,e){var r=t[e];return n+(1==r?e:e+"^"+r)},"")}return{sort:t,insert:n,clear:e,pow:r,equals:s,empty:i,sortFunc:a,strSortFunc:u,strSort:o,strParse:c,strValue:f,len:l,clone:g,string:h}}(),window.Slang=window.Slang||{},window.Slang._mathslang=window.Slang._mathslang||{},window.Slang._mathslang.impl=function(){function t(t){}function n(){return Slang._mathslang.lexical}function e(){return Slang._mathslang.syntax}function r(){return Slang._mathslang.semantix}function s(s,i,a){try{return a&&(s=n().replace_units(s,a),i=n().replace_units(i,a)),n().empty(s)||n().empty(i)?!1:(s=e().present(s),i=e().present(i),e().string(s)==e().string(i)?(t("syntax equality: "+e().string(s)+" = "+e().string(i)),!0):(s=r().represent(s),i=r().represent(i),s.string()==i.string()?(t("semantix equality: "+s.string()+" = "+i.string()),!0):s.calc()==i.calc()?(t("constant equality: "+s.string()+" = "+i.string()),!0):(s=s.simplify(3),i=i.simplify(3),s.string()==i.string()?(t("simplify equality: "+s.string()+" = "+i.string()),!0):(t("no semantix equality: "+s.string()+" = "+i.string()),!1))))}catch(u){return!1}}function i(r,s,i){try{return i&&(r=n().replace_units(r,i),s=n().replace_units(s,i)),n().empty(r)||n().empty(s)?!1:(r=e().present(r),s=e().present(s),e().string(r)==e().string(s)?(t("syntax equality: "+e().string(r)+" = "+e().string(s)),!0):(t("no syntax equality: "+e().string(r)+" = "+e().string(s)),!1))}catch(a){return!1}}function a(e,s,i,a){try{if("number"==typeof e&&(e=""+e),"number"==typeof s&&(s=""+s),"string"==typeof i&&(i=parseFloat(i)),a&&(e=n().replace_units(e,a),s=n().replace_units(s,a)),n().empty(e)||n().empty(s))return!1;e=r().present(e),s=r().present(s);var u=e.clone(),o=s.clone();return u.free_const(),o.free_const(),u=u.simplify(3),o=o.simplify(3),u.string()!=o.string()?!1:(e.free_imag(),s.free_imag(),e=e.simplify(2),s=s.simplify(2),e=e.calc(),s=s.calc(),isNaN(e)||isNaN(s)?!1:Math.abs(e-s)<=i+2.31e-16?(t("approx equality: "+e+" = "+s+" (epsilon = "+i+")"),!0):!1)}catch(i){return!1}}function u(t,e){function s(t,n,e){return t.substr(0,n)+e+t.substr(n+e.length)}e&&(t=n().replace_units(t,e)),t=r().present(t),t=t.simplify(3),t.free_const(),t=r().unit(t);for(var i=0;i<t.length;++i)if(i>0&&"^"==t[i-1]&&"-"==t[i]){for(var a=0;" "==t[i-2-a];)++a;if(")"==t[i-2-a]){for(var u=1,o=1;o>0&&i-2-a-u>=0;){var c=t[i-2-a-u];o+="("==c?-1:")"==c?1:0,++u}for(;u>=0;)--u}else t=s(t,i-0,"^"),t=s(t,i-1,t[i-2]),t=s(t,i-2,"/")}return t=t.replace(/1/g,"")}return{match:s,matchSyntax:i,matchApprox:a,extractUnit:u}}(),window.Slang=window.Slang||{},window.Slang._mathslang=window.Slang._mathslang||{},window.Slang._mathslang.lexical=function(){function t(t,n){this.flag=t,this.code=n,this.inv=!1}function n(n){n=u(n);for(var e=[],r=i(n).split("");r.length>0;){var s=0,g="";if(c.test(r[0])){do r.shift();while(c.test(r[0]))}else if(f[0].test(r[0])){r.shift(),g="",s=o.L;for(var h=1,p="";h>0;){if(g+=p,0==r.length)throw")";p=r.shift(),h+=f[0].test(p)?1:f[1].test(p)?-1:0}e.push(new t(s,g))}else{for(;s<l.length;){var m=l[s];if(m.test(r[0]))do g=g.concat(r.shift());while(m.plu&&m.test(r[0]));g.length>0?(e.push(new t(s,g)),s=l.length):s++}if(0==g.length)throw r.shift()}}return a(e)}function e(t){for(var n=0;n<t.length;n++)if(!c.test(t[n]))return!1;return!0}function r(t,n){function e(t,n,e){return t.substr(0,n)+e+t.substr(n+e.length)}var r=!0,s=!0;n.split(" ").forEach(function(n){switch(n){case"weight":t=t.replace(/ton/g,"(�1000000g)"),s&&(t=t.replace(/t/g,"(�1000000g)")),t=t.replace(/Kg/g,"(�1000g)"),t=t.replace(/kg/g,"(�1000g)"),t=t.replace(/mg/g,"(�0.001g)");break;case"distance":t=t.replace(/Km/g,"(� 1000m)"),t=t.replace(/km/g,"(� 1000m)"),t=t.replace(/dm/g,"(� 0.100m)"),t=t.replace(/cm/g,"(� 0.010m)"),t=t.replace(/mm/g,"(� 0.001m)"),t=t.replace(/min/g,"(� 60s)"),t=t.replace(/m/g,"(� m)"),r=!1;break;case"time":t=t.replace(/min/g,"(� 60s)"),r&&(t=t.replace(/m/g,"(� 60s)")),t=t.replace(/h/g,"(� 3600s)"),t=t.replace(/s/g,"(� s)"),s=!1;break;default:throw"mathslang does not support unit `"+n+"'"}});for(var i=0;i<t.length;++i)if("�"==t[i]){if(i&&"("!=t[i-1])throw t[i-1]+"� instead of (�";var a=2;do{for(;" "==t[i-a];)++a;if(i>=a&&")"==t[i-a]){for(var u=1;u>0&&i>a;){var o=t[i-++a];u+=")"==o?1:"("==o?-1:0}++a}for(;" "==t[i-a];)++a;for(;i>=a&&/^[0-9a-zA-Z]$/.test(t[i-a]);)++a;for(;" "==t[i-a];)++a}while(i>=a&&")"==t[i-a]);if("/"==t[i-a]){for(var c=0;a>c+2;++c)t=e(t,i-c,t[i-c-2]);t=e(t,i-a+1," "),t=e(t,i-a+2,"(")}}return t.replace(/\�/g,"")}function s(t,n){this.exp=n,this.plu=t,this.test=function(t){return this.exp.test(t)}}function i(t){return t=t.replace(/�/g,"^2"),t=t.replace(/�/g,"^3"),t=t.replace(/\u00B2/g,"^2"),t=t.replace(/\u00B3/g,"^3"),t=t.replace(/,/g,".")}function a(t){var n=[],e=!1;for(var r in t){if(t[r].flag==o.O)switch(t[r].code){case"-":t[r].inv=!t[r].inv;case"+":break;case"/":e=!0;case"*":continue;default:throw"operator `"+t[r].code+"' has not been implemented."}else if(t[r].flag==o.E){if(0==n.length)throw"radix ahead `"+t[r].code+"' is undefined.";var s=n.pop();if(s.flag==o.O)throw"radix is not allowed to be an `"+s.code+"' operator.";t[r].code=s.code,t[r].inv=s.inv}else e&&(t[r].inv=!(e=!1));n.push(t[r])}return n}function u(t){for(var n={"Sqrt(�)":"�^.5","sqrt(�)":"�^.5","root(�)":"�^.5","wurzel(�)":"�^.5","Wurzel(�)":"�^.5","R007(�)":"�^.5"},e=Object.keys(n),r=0;r<t.length;++r)for(var s=0;s<e.length;++s)for(var i=0;e[s][i]==t[r+i];)if(++i,"�"==e[s][i]){for(var a="",u=0,o="";(o=t[r+i+u])!=e[s][i+1];)a+=o,++u;t=t.substr(0,r)+"("+n[e[s]]+t.substr(r+i+u,t.length),t=t.replace("�","("+a+")")}return t}var o={O:0,E:1,X:2,N:3,L:7},c=new s(!0,/^\s$/),f=[new s(!1,/^\(|\[|\{$/),new s(!1,/^\)|\]|\}$/)],l=[new s(!1,/^\+|\-|\*|\/$/),new s(!1,/^\^$/),new s(!1,/^[a-zA-Z]$/),new s(!0,/^[0-9]|\,|\.$/)];return{FLAG:o,T:t,iter:n,empty:e,replace_units:r}}(),window.Slang=window.Slang||{},window.Slang._mathslang=window.Slang._mathslang||{},window.Slang._mathslang.semantix=function(){function t(t,n,e){this.fact=void 0!==t?t:1,this.imag=void 0!==n?n:{},this.sums=void 0!==e?e:[]}function n(t,n,e){this.offset=void 0!==t?t:0,this.queues=void 0!==n&&n.length?n:[],this.expont=void 0!==e?e:null}function e(){return Slang._mathslang.imaginary}function r(){return Slang._mathslang.syntax}function s(t){if("string"!=typeof t)throw"`Seman.present(string)' got `"+typeof t+"' instead of `string'";var n=r().present(t);return i(n)}function i(r){var s=new n;return r.forEach(function(r){var u=new t;u.fact=r.fact?r.fact.reduce(function(t,n){return t*n},1):1,u.imag=e().strParse(r.imag),r.exps.forEach(function(e){var r=i(e.radix),s=i(e.power),a=r.expont;if(r.expont=s,a){var o=new n;r.expont=a,o.expont=s,o.queues.push(new t(1,{},[r])),r=o}u.sums.push(r)}),r.sums.forEach(function(t){var n=i(t);u.sums.push(n)}),a(u)?s.offset+=u.fact:s.queues.push(u)}),s=s.solidify()}function a(t){return 0==e().len(t.imag)&&0==t.sums.length}function u(t){return Object.keys(t.imag).length>0?NaN:t.fact*t.sums.reduce(function(t,n){return t*n.calc()},1)}function o(n){var r=new t;return r.fact=n.fact,r.imag=e().clone(n.imag),r.sums=n.sums.map(function(t){return t.clone()}),r}function c(r,s){if(null!=r.expont)throw"`expansion': `s0.expont != null'";if(null!=s.expont)throw"`expansion': `s1.expont != null'";var i=r.offset*s.offset,a=r.queues.map(function(n){return new t(s.offset*n.fact,e().clone(n.imag),n.sums)}).concat(s.queues.map(function(n){return new t(r.offset*n.fact,e().clone(n.imag),n.sums)}));return r.queues.forEach(function(n){s.queues.forEach(function(r){var s={};e().insert(s,n.imag),e().insert(s,r.imag),a.push(new t(n.fact*r.fact,e().sort(s),n.sums.concat(r.sums)))})}),r=new n(i,a.filter(function(t){return 0!=t.fact}))}function f(t){var n,e,r,s=[];n=t.sums.reduce(function(t,n,e){n=n.combine(n);var r=n.expont;n.expont=null;var s=n.string();return n.expont=r,t[s]?t[s].push(e):t[s]=[e],t},new Object),e=Object.keys(n);for(var i=0;i<e.length;i++)r=n[e[i]],r.length>1&&(s=s.concat(l(t.sums,r)));return s.sort(function(t,n){return n-t}).forEach(function(n){t.sums.splice(n,1)}),t}function l(e,r){if(r.length<2)throw"`combineE': "+r.length+"/2 indices";var s=[],i=new n,a=new n;for(a.offset=e[r[0]].offset,a.queues=e[r[0]].queues;r.length;){var u=e[r[0]].expont;u?u.expont?i.queues.push(new t(1,{},[u])):(i.offset+=u.offset,i.queues=i.queues.concat(u.queues)):i.offset++,s.push(r[0]),r.splice(0,1)}return a.expont=i,e.push(a),s}function g(t){for(var n="",e=0;e<t.queues.length;++e){var r=t.queues[e];n=Object.keys(r.imag).reduce(function(t,n){var e=r.imag[n];return t+(1==e?n:-1==e?"1/"+n:n+"^"+e)},n),r.sums.forEach(function(t){n+="("+g(t)+")"}),e+1<t.queues.length&&(n+=" + ")}return t.expont?n+"^"+g(t.expont):n}return t.prototype.ident=function(){return this.fact*this.sums.reduce(function(t,n){return t*n.calc()},1)==1&&e().empty(this.imag)},t.prototype.string=function(){return this.sums.reduce(function(t,n){return t+"("+n.string()+")"},""+this.fact+e().string(this.imag))},t.prototype.pow=function(n){return new t(Math.pow(this.fact,n),Object.keys(this.imag).reduce(function(t,e){return t[e]=this.imag[e]*n,t},{}))},t.prototype.extract=function(){for(var r=this,s=new n(0,[new t(r.fact,e().clone(r.imag))]),i=0;i<r.sums.length;)r.sums[i].expand(),null==r.sums[i].expont?(s=c(s,r.sums[i]),r.sums.splice(i,1)):i++;return s},n.prototype.calc=function(){var t=this.offset+this.queues.reduce(function(t,n){return t+u(n)},0);return this.expont?Math.pow(t,this.expont.calc()):t},n.prototype.expand=function(){for(var t=0;t<this.queues.length;){var n=this.queues[t].extract();if(e().clear(this.queues[t].imag),this.queues[t].fact=1,this.queues[t].ident()){if(n.expont)throw"`expand': `s0.expont' must be `null'.";this.queues.splice(t,1),this.offset+=n.offset,this.queues=n.queues.concat(this.queues),t+=n.queues.length}else 1!=n.calc()&&this.queues[t].sums.push(n),++t}return this},n.prototype.combine=function(){var t=this.offset,r=[],s=void 0,i=this.expont;return i&&(i=this.expont.combine()),this.queues.filter(function(n){var e=u(n);return isNaN(e)?!0:(t+=e,!1)}).map(f).sort(function(t,n){return-e().sortFunc(t.imag,n.imag)}).forEach(function(t){void 0!=s&&e().equals(s.imag,t.imag)&&0==s.sums.length&&0==t.sums.length?r[0].fact+=t.fact:(r.unshift(t),s=t)}),r=r.filter(function(t){return 0!=t.fact}),new n(t,r,i).solidify()},n.prototype.string=function(){var t=this.expont?!0:!1;return this.queues.reduce(function(t,n){var e=n.string();return t+(n.fact<0?e:"+"+e)},(t?"(":"")+this.offset)+(t?")^("+this.expont.string()+")":"")},n.prototype.simplify=function(t){var n=this;do n=n.expand(),n=n.combine(),n=n.expow();while(--t>0);return n},n.prototype.expow=function(){function r(t){if(0==t.offset&&1==t.queues.length&&t.expont){for(var r=t.expont,s=t.queues[0],t=new n(0,[s]),i=0;i<s.sums.length;i++)s.sums[i].expont=c(s.sums[i].expont,r.clone());var a=r.calc();isNaN(a)?(s.sums.push(new n(s.fact,s.imag,r.clone())),s.fact=1,s.imag={}):(s.fact=Math.pow(s.fact,a),e().pow(s.imag,a))}return t}var s=r(this),i=s.expont?s.expont.calc():NaN;if(isNaN(i))s.expont&&s.expont.expont;else{for(var a=[];i>1;){var u=new n;u.offset=s.offset,u.queues=s.queues.map(o),a.push(u),i--}s.expont=1==i?null:new n(i),a.length&&(a.unshift(s),s=new n,s.queues.push(new t(1,{},a)))}return s.queues.forEach(function(t){t.sums=t.sums.map(function(t){return t.expow()})}),s=s.solidify()},n.prototype.solidify=function(){var t=this,n=t.expont?t.expont.calc():NaN;return 0!=t.offset||1!=t.queues.length||1!=t.queues[0].fact||0!=t.queues[0].sums||isNaN(n)?t.queues.forEach(function(t){return t.sums.map(function(t){return t.solidify()})}):(e().pow(t.queues[0].imag,n),t.expont=null),0!=t.offset||1!=t.queues.length||t.expont||1!=t.queues[0].fact||0!=e().len(t.queues[0].imag)||1!=t.queues[0].sums.length?t:t.queues[0].sums[0].solidify()},n.prototype.clone=function(){var t=this,e=new n;return e.offset=t.offset,e.queues=t.queues.map(o),e.expont=t.expont?t.expont.clone():null,e},n.prototype.free_const=function(){var t=this;t.offset=0,t.queues.forEach(function(t){t.fact=1,t.sums.forEach(function(t){t.free_const()})}),t.expont&&t.expont.free_const()},n.prototype.free_imag=function(){this.queues.forEach(function(t){t.imag="",t.sums.forEach(function(t){t.free_imag()})}),this.expont&&this.expont.free_imag()},{present:s,represent:i,unit:g}}(),window.Slang=window.Slang||{},window.Slang._mathslang=window.Slang._mathslang||{},window.Slang._mathslang.syntax=function(){function t(){this.fact=[],this.imag="",this.exps=[],this.sums=[]}function n(){this.radix=[],this.power=[]}function e(){return Slang._mathslang.lexical}function r(t){if("string"!=typeof t)throw"syntax.present(typeof s = "+typeof t+")";var n=e().iter(t),r=[];do{for(var i=!1;n.length>0&&n[0].flag==e().FLAG.O;)n.shift().inv&&(i=!i);var a=s(n);a&&(i&&a.fact.unshift(-1),r.push(a))}while(n.length>0);return c(r),r}function s(s){for(var o=new t;s.length>0;)switch(s[0].flag){case e().FLAG.N:var c=parseFloat(s[0].code);if(s.shift().inv){if(0==c)throw"`pluckQ' divided by 0.";c=1/c}o.fact.push(c);break;case e().FLAG.X:var f=s[0].code;if(s.shift().inv){var l=new n;l.radix.push(u(f)),l.power.push(a(-1)),o.exps.push(l)}else o.imag+=f;break;case e().FLAG.E:var l=new n;s[0].inv,l.radix=r(s.shift().code),l.power=i(s),o.exps.push(l);break;case e().FLAG.L:var g=r(s[0].code);if(s.shift().inv){var l=new n;l.radix=g,l.power.push(a(-1)),o.exps.push(l)}else o.sums.push(g);break;case e().FLAG.O:default:return p(o)?null:o}return p(o)?null:o}function i(t){if(!(t.length>0))throw"`pluckT' without any token.";switch(t[0].flag){case e().FLAG.N:return[a(t.shift().code)];case e().FLAG.X:return[u(t.shift().code)];case e().FLAG.E:var s=new n;if(t[0].inv)throw"`pluckT("+t[0].code+"..)' illegal `inv'";return s.radix=r(t.shift().code),s.power=i(t,!0),[o(s)];case e().FLAG.L:return r(t.shift().code);case e().FLAG.O:t.shift();var c=i(t);return c.forEach(function(t){t.fact.push(-1)}),c;default:throw"`pluckT' invalid `flag=?'."}}function a(n){var e=new t;return e.fact.push(n),e}function u(n){var e=new t;return"string"!=typeof n?(console.log("not a string"),e):(e.imag=n,e)}function o(n){var e=new t;return"E"!=typeof n?(console.log("not a E"),e):(e.exps.push(n),e)}function c(t){t.forEach(function(t){f(t)}),t.sort(function(t,n){return Slang._mathslang.imaginary.strSortFunc(t.imag,n.imag)})}function f(t){t.sums.forEach(function(t){c(t)}),t.fact.sort(function(t,n){return t-n}),t.imag=Slang._mathslang.imaginary.strSort(t.imag),t.exps.sort(function(t,n){return g(t)-g(n)}),t.sums.sort(function(t,n){return l(t)-l(n)})}function l(t){return t.reduce(function(t,n){return t+h(n)},0)}function g(t){return Math.pow(16536421.3572347+l(t.radix),l(t.power))}function h(t){return t.fact.reduce(function(t,n){return t*n},1)*Slang._mathslang.imaginary.strValue(t.imag)*t.exps.reduce(function(t,n){return t*g(n)},1)*t.sums.reduce(function(t,n){return t*l(n)},1)}function p(t){return 0==t.fact.length&&0==t.imag.length&&0==t.exps.length&&0==t.sums.length}function m(t){var n="";if(t.length){n+=w(t[0]);for(var e=1;e<t.length;e++){var r=t[e].fact.reduce(function(t,n){return t*n},1),s=w(t[e]);n+=0>r?s:"+"+s}}return n}function w(t){var n="";if(t.fact.length){n+=t.fact[0];for(var e=1;e<t.fact.length;e++)n+="*"+t.fact[e]}return n+=t.imag,n+=t.exps.reduce(function(t,n){return t+d(n)},""),n+=t.sums.reduce(function(t,n){return t+"("+m(n)+")"},"")}function d(t){return"("+m(t.radix)+")^("+m(t.power)+")"}return{Q:t,E:n,present:r,pluckQ:s,N2Q:a,X2Q:u,sort:c,emptyQ:p,string:m,stringQ:w}}();