"use strict";var Slang=Slang||{};Slang.colorslang=function(){function t(t,e){return t.toLowerCase()===n(e).toLowerCase()}function n(t){return"#"+((1<<24)+(t[0]<<16)+(t[1]<<8)+t[2]).toString(16).slice(1)}return{compare:t}}();var Slang=Slang||{};Slang.hausdorffslang=function(){function t(t,n,e,i,a){var s=o(t,n,e,i,a);return 1-Math.max(r(s.X,s.Y),r(s.Y,s.X))}function n(t,n){var e=t.x-n.x,r=t.y-n.y;return Math.sqrt(e*e+r*r)}function e(t,e){return e.reduce(function(e,r){var i=n(t,r);return e>i?i:e},1/0)}function r(t,n){return t.reduce(function(t,r){var i=e(r,n);return i>t?i:t},0)}function i(t){var n=t.reduce(function(t,n){return{x0:t.x0+n.x,y0:t.y0+n.y}},{x0:0,y0:0});return n.x0/=t.length,n.y0/=t.length,n}function a(t,n,e,r){var i=e?n.x0:0,a=r?n.y0:0;return t.map(function(t){return{x:t.x-i,y:t.y-a}})}function s(t){return t.reduce(function(t,n){return{xmax:Math.max(n.x,t.xmax),xmin:Math.min(n.x,t.xmin),ymax:Math.max(n.y,t.ymax),ymin:Math.min(n.y,t.ymin)}},{xmax:-(1/0),ymax:-(1/0),xmin:1/0,ymin:1/0})}function u(t,n,e,r){var i=Math.abs(n.xmax-n.xmin),a=Math.abs(e.xmax-e.xmin),s=Math.abs(n.ymax-n.ymin),u=Math.abs(e.ymax-e.ymin),o=a/i,c=u/s,f=2*o*c/(o+c);return t.map(function(t){return{x:r.x0+(r.x0-t.x)/f,y:r.y0+(r.y0-t.y)/f}})}function o(t,n,e,r,o){if(e||r||o){var c=i(t),f=i(n);if(o){var l=s(t),g=s(n);n=u(n,l,g,f)}(e||r)&&(t=a(t,c,e,r),n=a(n,f,e,r))}return{X:t,Y:n}}return{compare:t}}();var Slang=Slang||{};Slang.langslang=function(){function t(t,n){return Slang.logicslang.compare(t,n,e)}function n(t,n){var e=[];if(t==n)return 0;if(0==t.length)return n.length;if(0==n.length)return t.length;for(var r=0;r<t.length+1;r++){e[r]=[];for(var i=0;i<n.length+1;i++)0==r||0==i?e[r][i]=Math.max(r,i):(e[r][i]=Math.min(e[r-1][i]+1,e[r][i-1]+1,e[r-1][i-1]+(t[r-1]==n[i-1]?0:1)),i>1&&r>1&&t[r-1]==n[i-2]&&t[r-2]==n[i-1]&&(e[r][i]=Math.min(e[r][i],e[r-2][i-2]+1)))}return e[t.length][n.length]}function e(t,n){if(t=t.trim(),n=n.trim(),0!==t.indexOf("#"))return t===n;var e=t.substr(1,t.indexOf(" ")-1);return t=t.substr(t.indexOf(" ")+1),"typo"===e?r(i(t),i(n)):"nocase"===e?i(t)===i(n):"regex"===e?(t=new RegExp(t),t.test(n)):void 0}function r(t,e){var r=n(t,e);return r<Math.ceil(Math.sqrt(t.length)-1)}function i(t){return t.toLowerCase()}return{compare:t}}(),Slang.langslang._damerauLevenshtein=function(t,n){var e=[];if(t==n)return 0;if(0==t.length)return n.length;if(0==n.length)return t.length;for(var r=0;r<t.length+1;r++){e[r]=[];for(var i=0;i<n.length+1;i++)0==r||0==i?e[r][i]=Math.max(r,i):(e[r][i]=Math.min(e[r-1][i]+1,e[r][i-1]+1,e[r-1][i-1]+(t[r-1]==n[i-1]?0:1)),i>1&&r>1&&t[r-1]==n[i-2]&&t[r-2]==n[i-1]&&(e[r][i]=Math.min(e[r][i],e[r-2][i-2]+1)))}return e[t.length][n.length]},window.Slang=window.Slang||{},window.Slang.logicslang={compare:function(t,n,e,r){if("object"==typeof n)for(var i in n){var a=new RegExp("@"+i,"g");t=t.replace(a,n[i])}var s=new LogicParser(e);return s.compare(t,n,r)}};var LogicParser=function(t){function n(t){var n=[];return n=t.split(/(#and|#or|#not|<&|&|<|>)/),n=n.map(function(t){return t.trim()}),n=n.filter(function(t){return t.length>0})}function e(){if("#not"==i[0])return i.shift(),!r();var t=r();if("#and"===i[0]||"#or"===i[0]){var n=i.shift(),e=r();return"#and"===n?t&&e:t||e}return t}function r(){var n=i.shift(),r="";if("<"==n){r=e();var o=i.shift();if(">"!=o)throw u;return r}if("<&"==n){var c=a;a=i.shift();var f=i.shift();if("&"!=f)throw u;r=e();var o=i.shift();if(">"!=o)throw u;return a=c,r}if(">"==n)throw u;return t(n,a,s)}var i=[],a="",s=void 0,u="ERROR: Mismatched parentheses";this.compare=function(t,r,u){return i=n(t),a=r,s=u,e()}};window.Slang=window.Slang||{},window.Slang.mathslang=function(){function t(t,n,e){return Slang.logicslang.compare(t,n,this._compare,e)}function n(t,n,e){n+="",t+="";if(n=n.trim(),t=t.trim(),0===t.indexOf("#")){var r=t.substr(1,t.indexOf(" ")-1);switch(t=t.substr(t.indexOf(" ")+1),r){case"equals":return o(t,n,e);case"identic":return c(t,n);case"approx":var i=t.split("#epsilon");return f(i[0],n,i[1],e);case"lt":return parseFloat(n)<parseFloat(t);case"leq":return parseFloat(n)<=parseFloat(t);case"gt":return parseFloat(n)>parseFloat(t);case"geq":return parseFloat(n)>=parseFloat(t);case"vecEquals":return Slang._mathslang.vec.compare(t,n);default:return t===n}}}function e(t){var n="";[/Km/,/km/,/dm/,/cm/,/mm/].some(function(n){return n.test(t)})&&(n+="distance "),[/Kg/,/kg/,/g/,/mg/].some(function(n){return n.test(t)})&&(n+="weight "),[/h/,/min/,/s/,/ms/].some(function(n){return n.test(t)})&&(n+="time ");var e=t.split("m");return-1==n.indexOf("distance")&&e.length>1&&e.some(function(t){var n="gs".split("").every(function(n){return!t.length||n!=t[0]}),e="Kkdc".split("").every(function(n){return!t.length||n!=t[t.length-1]});return n&&e})&&(n="distance "+n),n.trim()}function r(t,n){function e(t,n,e){return t.substr(0,n)+e+t.substr(n+e.length)}n&&(t=a().replace_units(t,n)),t=u().present(t),t=t.simplify(3),t.free_const(),t=t.unit();for(var r=0;r<t.length;++r)if(r>0&&"^"==t[r-1]&&"-"==t[r]){for(var i=0;" "==t[r-2-i];)++i;if(")"==t[r-2-i]){for(var s=1,o=1;o>0&&r-2-i-s>=0;){var c=t[r-2-i-s];o+="("==c?-1:")"==c?1:0,++s}for(;s>=0;)--s}else t=e(t,r-0,"^"),t=e(t,r-1,t[r-2]),t=e(t,r-2,"/")}return t=t.replace(/1/g,"")}function i(t){}function a(){return Slang._mathslang.lexical}function s(){return Slang._mathslang.syntax}function u(){return Slang._mathslang.semantix}function o(t,n,e){try{return e&&(t=a().replace_units(t,e),n=a().replace_units(n,e)),a().empty(t)||a().empty(n)?!1:(t=s().present(t),n=s().present(n),s().string(t)==s().string(n)?(i("syntax equality: "+s().string(t)+" = "+s().string(n)),!0):(t=u().represent(t),n=u().represent(n),t.string()==n.string()?(i("semantix equality: "+t.string()+" = "+n.string()),!0):t.calc()==n.calc()?(i("constant equality: "+t.string()+" = "+n.string()),!0):(t=t.simplify(3),n=n.simplify(3),t.string()==n.string()?(i("simplify equality: "+t.string()+" = "+n.string()),!0):(i("no semantix equality: "+t.string()+" = "+n.string()),!1))))}catch(r){return!1}}function c(t,n,e){try{return e&&(t=a().replace_units(t,e),n=a().replace_units(n,e)),a().empty(t)||a().empty(n)?!1:(t=s().present(t),n=s().present(n),s().string(t)==s().string(n)?(i("syntax equality: "+s().string(t)+" = "+s().string(n)),!0):(i("no syntax equality: "+s().string(t)+" = "+s().string(n)),!1))}catch(r){return!1}}function f(t,n,e,r){try{if("number"==typeof t&&(t=""+t),"number"==typeof n&&(n=""+n),"string"==typeof e&&(e=parseFloat(e)),r&&(t=a().replace_units(t,r),n=a().replace_units(n,r)),a().empty(t)||a().empty(n))return!1;t=u().present(t),n=u().present(n);var s=t.clone(),o=n.clone();return s.free_const(),o.free_const(),s=s.simplify(3),o=o.simplify(3),s.string()!=o.string()?!1:(t.free_imag(),n.free_imag(),t=t.simplify(2),n=n.simplify(2),t=t.calc(),n=n.calc(),isNaN(t)||isNaN(n)?!1:Math.abs(t-n)<=e+2.31e-16?(i("approx equality: "+t+" = "+n+" (epsilon = "+e+")"),!0):!1)}catch(e){return!1}}return{compare:t,_compare:n,extractUnit:e,stringUnit:r}}(),window.Slang=window.Slang||{},window.Slang._mathslang=window.Slang._mathslang||{},window.Slang._mathslang.imaginary=function(){function t(t){var n={};return Object.keys(t).sort(function(t,n){return t.charCodeAt(0)-n.charCodeAt(0)}).forEach(function(e){n[e]=t[e]}),n}function n(t,n){Object.keys(n).forEach(function(e){t[e]?t[e]+=n[e]:t[e]=n[e],t[e]||delete t[e]})}function e(t,n){Object.keys(t).forEach(function(e){n?t[e]*=n:delete t[e]})}function r(t){return 0==Object.keys(t).length}function i(t){return Object.keys(t).reduce(function(n,e){return n[e]=t[e],n},{})}function a(t){return Object.keys(t).reduce(function(n,e){var r=t[e];return n+(1==r?e:e+"^"+r)},"")}return{sort:t,insert:n,pow:e,empty:r,clone:i,string:a}}(),window.Slang=window.Slang||{},window.Slang._mathslang=window.Slang._mathslang||{},window.Slang._mathslang.impl=function(){function t(t){}function n(){return Slang._mathslang.lexical}function e(){return Slang._mathslang.syntax}function r(){return Slang._mathslang.semantix}function i(i,a,s){try{return s&&(i=n().replace_units(i,s),a=n().replace_units(a,s)),n().empty(i)||n().empty(a)?!1:(i=e().present(i),a=e().present(a),e().string(i)==e().string(a)?(t("syntax equality: "+e().string(i)+" = "+e().string(a)),!0):(i=r().represent(i),a=r().represent(a),i.string()==a.string()?(t("semantix equality: "+i.string()+" = "+a.string()),!0):i.calc()==a.calc()?(t("constant equality: "+i.string()+" = "+a.string()),!0):(i=i.simplify(3),a=a.simplify(3),i.string()==a.string()?(t("simplify equality: "+i.string()+" = "+a.string()),!0):(t("no semantix equality: "+i.string()+" = "+a.string()),!1))))}catch(u){return!1}}function a(r,i,a){try{return a&&(r=n().replace_units(r,a),i=n().replace_units(i,a)),n().empty(r)||n().empty(i)?!1:(r=e().present(r),i=e().present(i),e().string(r)==e().string(i)?(t("syntax equality: "+e().string(r)+" = "+e().string(i)),!0):(t("no syntax equality: "+e().string(r)+" = "+e().string(i)),!1))}catch(s){return!1}}function s(e,i,a,s){try{if("number"==typeof e&&(e=""+e),"number"==typeof i&&(i=""+i),"string"==typeof a&&(a=parseFloat(a)),s&&(e=n().replace_units(e,s),i=n().replace_units(i,s)),n().empty(e)||n().empty(i))return!1;e=r().present(e),i=r().present(i);var u=e.clone(),o=i.clone();return u.free_const(),o.free_const(),u=u.simplify(3),o=o.simplify(3),u.string()!=o.string()?!1:(e.free_imag(),i.free_imag(),e=e.simplify(2),i=i.simplify(2),e=e.calc(),i=i.calc(),isNaN(e)||isNaN(i)?!1:Math.abs(e-i)<=a+2.31e-16?(t("approx equality: "+e+" = "+i+" (epsilon = "+a+")"),!0):!1)}catch(a){return!1}}function u(t,e){function i(t,n,e){return t.substr(0,n)+e+t.substr(n+e.length)}e&&(t=n().replace_units(t,e)),t=r().present(t),t=t.simplify(3),t.free_const(),t=r().unit(t);for(var a=0;a<t.length;++a)if(a>0&&"^"==t[a-1]&&"-"==t[a]){for(var s=0;" "==t[a-2-s];)++s;if(")"==t[a-2-s]){for(var u=1,o=1;o>0&&a-2-s-u>=0;){var c=t[a-2-s-u];o+="("==c?-1:")"==c?1:0,++u}for(;u>=0;)--u}else t=i(t,a-0,"^"),t=i(t,a-1,t[a-2]),t=i(t,a-2,"/")}return t=t.replace(/1/g,"")}return{match:i,matchSyntax:a,matchApprox:s,extractUnit:u}}(),window.Slang=window.Slang||{},window.Slang._mathslang=window.Slang._mathslang||{},window.Slang._mathslang.lexical=function(){function t(t,n){this.flag=t,this.code=n,this.inv=!1}function n(n){n=u(n);for(var e=[],r=a(n).split("");r.length>0;){var i=0,g="";if(c.test(r[0])){do r.shift();while(c.test(r[0]))}else if(f[0].test(r[0])){r.shift(),g="",i=o.L;for(var h=1,p="";h>0;){if(g+=p,0==r.length)throw")";p=r.shift(),h+=f[0].test(p)?1:f[1].test(p)?-1:0}e.push(new t(i,g))}else{for(;i<l.length;){var m=l[i];if(m.test(r[0]))do g=g.concat(r.shift());while(m.plu&&m.test(r[0]));g.length>0?(e.push(new t(i,g)),i=l.length):i++}if(0==g.length)throw r.shift()}}return s(e)}function e(t){for(var n=0;n<t.length;n++)if(!c.test(t[n]))return!1;return!0}function r(t,n){function e(t,n,e){return t.substr(0,n)+e+t.substr(n+e.length)}var r=!0,i=!0;n.split(" ").forEach(function(n){switch(n){case"weight":t=t.replace(/ton/g,"(°1000000g)"),i&&(t=t.replace(/t/g,"(°1000000g)")),t=t.replace(/Kg/g,"(°1000g)"),t=t.replace(/kg/g,"(°1000g)"),t=t.replace(/mg/g,"(°0.001g)");break;case"distance":t=t.replace(/Km/g,"(° 1000m)"),t=t.replace(/km/g,"(° 1000m)"),t=t.replace(/dm/g,"(° 0.100m)"),t=t.replace(/cm/g,"(° 0.010m)"),t=t.replace(/mm/g,"(° 0.001m)"),t=t.replace(/min/g,"(° 60s)"),t=t.replace(/m/g,"(° m)"),r=!1;break;case"time":t=t.replace(/min/g,"(° 60s)"),r&&(t=t.replace(/m/g,"(° 60s)")),t=t.replace(/h/g,"(° 3600s)"),t=t.replace(/s/g,"(° s)"),i=!1;break;default:throw"mathslang does not support unit `"+n+"'"}});for(var a=0;a<t.length;++a)if("°"==t[a]){if(a&&"("!=t[a-1])throw t[a-1]+"° instead of (°";var s=2;do{for(;" "==t[a-s];)++s;if(a>=s&&")"==t[a-s]){for(var u=1;u>0&&a>s;){var o=t[a-++s];u+=")"==o?1:"("==o?-1:0}++s}for(;" "==t[a-s];)++s;for(;a>=s&&/^[0-9a-zA-Z]$/.test(t[a-s]);)++s;for(;" "==t[a-s];)++s}while(a>=s&&")"==t[a-s]);if("/"==t[a-s]){for(var c=0;s>c+2;++c)t=e(t,a-c,t[a-c-2]);t=e(t,a-s+1," "),t=e(t,a-s+2,"(")}}return t.replace(/\°/g,"")}function i(t,n){this.exp=n,this.plu=t,this.test=function(t){return this.exp.test(t)}}function a(t){return t=t.replace(/²/g,"^2"),t=t.replace(/³/g,"^3"),t=t.replace(/\u00B2/g,"^2"),t=t.replace(/\u00B3/g,"^3"),t=t.replace(/,/g,".")}function s(t){var n=[],e=!1;for(var r in t){if(t[r].flag==o.O)switch(t[r].code){case"-":t[r].inv=!t[r].inv;case"+":break;case"/":e=!0;case"*":continue;default:throw"operator `"+t[r].code+"' has not been implemented."}else if(t[r].flag==o.E){if(0==n.length)throw"radix ahead `"+t[r].code+"' is undefined.";var i=n.pop();if(i.flag==o.O)throw"radix is not allowed to be an `"+i.code+"' operator.";t[r].code=i.code,t[r].inv=i.inv}else e&&(t[r].inv=!(e=!1));n.push(t[r])}return n}function u(t){for(var n={"Sqrt(°)":"°^.5","sqrt(°)":"°^.5","root(°)":"°^.5","wurzel(°)":"°^.5","Wurzel(°)":"°^.5","R007(°)":"°^.5"},e=Object.keys(n),r=0;r<t.length;++r)for(var i=0;i<e.length;++i)for(var a=0;e[i][a]==t[r+a];)if(++a,"°"==e[i][a]){for(var s="",u=0,o="";(o=t[r+a+u])!=e[i][a+1];)s+=o,++u;t=t.substr(0,r)+"("+n[e[i]]+t.substr(r+a+u,t.length),t=t.replace("°","("+s+")")}return t}var o={O:0,E:1,X:2,N:3,L:7},c=new i(!0,/^\s$/),f=[new i(!1,/^\(|\[|\{$/),new i(!1,/^\)|\]|\}$/)],l=[new i(!1,/^\+|\-|\*|\/$/),new i(!1,/^\^$/),new i(!1,/^[a-zA-Zα-ωΓ-Ω]$/),new i(!0,/^[0-9]|\,|\.$/)];return{FLAG:o,T:t,iter:n,empty:e,replace_units:r}}(),window.Slang=window.Slang||{},window.Slang._mathslang=window.Slang._mathslang||{},window.Slang._mathslang.semantix=function(){function t(t,n,e){this.fact=void 0!==t?t:1,this.imag=void 0!==n?n:{},this.sums=void 0!==e?e:[]}function n(t,n,e){this.offset=void 0!==t?t:0,this.queues=void 0!==n&&n.length?n:[],this.expont=void 0!==e?e:null}function e(t){if("string"!=typeof t)throw"`Seman.present(string)' got `"+typeof t+"' instead of `string'";var n=a().present(t);return r(n)}function r(e){var i=new n;return e.forEach(function(e){var a=new t;a.fact=e.fact?e.fact.reduce(function(t,n){return t*n},1):1,a.imag=function(t){for(var n={},e=0;e<t.length;e++){var r=t[e];n[r]?n[r]++:n[r]=1}return n}(e.imag),e.exps.forEach(function(e){var i=r(e.radix),s=r(e.power),u=i.expont;if(i.expont=s,u){var o=new n;i.expont=u,o.expont=s,o.queues.push(new t(1,{},[i])),i=o}a.sums.push(i)}),e.sums.forEach(function(t){var n=r(t);a.sums.push(n)}),s(a)?i.offset+=a.fact:i.queues.push(a)}),i=i.solidify()}function i(){return Slang._mathslang.imaginary}function a(){return Slang._mathslang.syntax}function s(t){return 0==Object.keys(t.imag).length&&0==t.sums.length}function u(t){return Object.keys(t.imag).length>0?NaN:t.fact*t.sums.reduce(function(t,n){return t*n.calc()},1)}function o(n){var e=new t;return e.fact=n.fact,e.imag=i().clone(n.imag),e.sums=n.sums.map(function(t){return t.clone()}),e}function c(e,r){if(null!=e.expont)throw"`expansion': `s0.expont != null'";if(null!=r.expont)throw"`expansion': `s1.expont != null'";var a=e.offset*r.offset,s=e.queues.map(function(n){return new t(r.offset*n.fact,i().clone(n.imag),n.sums)}).concat(r.queues.map(function(n){return new t(e.offset*n.fact,i().clone(n.imag),n.sums)}));return e.queues.forEach(function(n){r.queues.forEach(function(e){var r={};i().insert(r,n.imag),i().insert(r,e.imag),s.push(new t(n.fact*e.fact,i().sort(r),n.sums.concat(e.sums)))})}),e=new n(a,s.filter(function(t){return 0!=t.fact}))}function f(t){var n,e,r,i=[];n=t.sums.reduce(function(t,n,e){n=n.combine(n);var r=n.expont;n.expont=null;var i=n.string();return n.expont=r,t[i]?t[i].push(e):t[i]=[e],t},new Object),e=Object.keys(n);for(var a=0;a<e.length;a++)r=n[e[a]],r.length>1&&(i=i.concat(l(t.sums,r)));return i.sort(function(t,n){return n-t}).forEach(function(n){t.sums.splice(n,1)}),t}function l(e,r){if(r.length<2)throw"`combineE': "+r.length+"/2 indices";var i=[],a=new n,s=new n;for(s.offset=e[r[0]].offset,s.queues=e[r[0]].queues;r.length;){var u=e[r[0]].expont;u?u.expont?a.queues.push(new t(1,{},[u])):(a.offset+=u.offset,a.queues=a.queues.concat(u.queues)):a.offset++,i.push(r[0]),r.splice(0,1)}return s.expont=a,e.push(s),i}return t.prototype.ident=function(){return this.fact*this.sums.reduce(function(t,n){return t*n.calc()},1)==1&&i().empty(this.imag)},t.prototype.string=function(){return this.sums.reduce(function(t,n){return t+"("+n.string()+")"},""+this.fact+i().string(this.imag))},t.prototype.pow=function(n){return new t(Math.pow(this.fact,n),Object.keys(this.imag).reduce(function(t,e){return t[e]=this.imag[e]*n,t},{}))},t.prototype.extract=function(){for(var e=this,r=new n(0,[new t(e.fact,i().clone(e.imag))]),a=0;a<e.sums.length;)e.sums[a].expand(),null==e.sums[a].expont?(r=c(r,e.sums[a]),e.sums.splice(a,1)):a++;return r},n.prototype.unit=function(){for(var t=this,n="",e=0;e<t.queues.length;++e){var r=t.queues[e];n=Object.keys(r.imag).reduce(function(t,n){var e=r.imag[n];return t+(1==e?n:-1==e?"1/"+n:n+"^"+e)},n),r.sums.forEach(function(t){n+="("+t.unit()+")"}),e+1<t.queues.length&&(n+=" + ")}return t.expont?n+"^"+t.expont.unit():n},n.prototype.calc=function(){var t=this.offset+this.queues.reduce(function(t,n){return t+u(n)},0);return this.expont?Math.pow(t,this.expont.calc()):t},n.prototype.expand=function(){for(var t=0;t<this.queues.length;){var n=this.queues[t].extract(),e=this.queues[t].imag;if(Object.keys(e).forEach(function(t){delete e[t]}),this.queues[t].fact=1,this.queues[t].ident()){if(n.expont)throw"`expand': `s0.expont' must be `null'.";this.queues.splice(t,1),this.offset+=n.offset,this.queues=n.queues.concat(this.queues),t+=n.queues.length}else 1!=n.calc()&&this.queues[t].sums.push(n),++t}return this},n.prototype.combine=function(){var t=this.offset,e=[],r=void 0,i=this.expont;return i&&(i=this.expont.combine()),this.queues.filter(function(n){var e=u(n);return isNaN(e)?!0:(t+=e,!1)}).map(f).sort(function(t,n){return-function(t,n){for(var e=Object.keys(t),r=Object.keys(n),i=Math.min(e.length,r.length),a=0;i>a;a++){if(e[a]<r[a])return-1;if(e[a]>r[a])return 1}var s=e.length-r.length;if(s)return s;for(var a=0;i>a;a++)if(s=t[e[a]]-n[r[a]])return s;return 0}(t.imag,n.imag)}).forEach(function(t){void 0!=r&&JSON.stringify(r.imag)==JSON.stringify(t.imag)&&0==r.sums.length&&0==t.sums.length?e[0].fact+=t.fact:(e.unshift(t),r=t)}),e=e.filter(function(t){return 0!=t.fact}),new n(t,e,i).solidify()},n.prototype.string=function(){var t=this.expont?!0:!1;return this.queues.reduce(function(t,n){var e=n.string();return t+(n.fact<0?e:"+"+e)},(t?"(":"")+this.offset)+(t?")^("+this.expont.string()+")":"")},n.prototype.simplify=function(t){var n=this;do n=n.expand(),n=n.combine(),n=n.expow();while(--t>0);return n},n.prototype.expow=function(){function e(t){if(0==t.offset&&1==t.queues.length&&t.expont){for(var e=t.expont,r=t.queues[0],t=new n(0,[r]),a=0;a<r.sums.length;a++)r.sums[a].expont=c(r.sums[a].expont,e.clone());var s=e.calc();isNaN(s)?(r.sums.push(new n(r.fact,r.imag,e.clone())),r.fact=1,r.imag={}):(r.fact=Math.pow(r.fact,s),i().pow(r.imag,s))}return t}var r=e(this),a=r.expont?r.expont.calc():NaN;if(isNaN(a))r.expont&&r.expont.expont;else{for(var s=[];a>1;){var u=new n;u.offset=r.offset,u.queues=r.queues.map(o),s.push(u),a--}r.expont=1==a?null:new n(a),s.length&&(s.unshift(r),r=new n,r.queues.push(new t(1,{},s)))}return r.queues.forEach(function(t){t.sums=t.sums.map(function(t){return t.expow()})}),r=r.solidify()},n.prototype.solidify=function(){var t=this,n=t.expont?t.expont.calc():NaN;return 0!=t.offset||1!=t.queues.length||1!=t.queues[0].fact||0!=t.queues[0].sums||isNaN(n)?t.queues.forEach(function(t){return t.sums.map(function(t){return t.solidify()})}):(i().pow(t.queues[0].imag,n),t.expont=null),0!=t.offset||1!=t.queues.length||t.expont||1!=t.queues[0].fact||0!=Object.keys(t.queues[0].imag).length||1!=t.queues[0].sums.length?t:t.queues[0].sums[0].solidify()},n.prototype.clone=function(){var t=this,e=new n;return e.offset=t.offset,e.queues=t.queues.map(o),e.expont=t.expont?t.expont.clone():null,e},n.prototype.free_const=function(){var t=this;t.offset=0,t.queues.forEach(function(t){t.fact=1,t.sums.forEach(function(t){t.free_const()})}),t.expont&&t.expont.free_const()},n.prototype.free_imag=function(){this.queues.forEach(function(t){t.imag="",t.sums.forEach(function(t){t.free_imag()})}),this.expont&&this.expont.free_imag()},{present:e,represent:r}}(),window.Slang=window.Slang||{},window.Slang._mathslang=window.Slang._mathslang||{},window.Slang._mathslang.syntax=function(){function t(){this.fact=[],this.imag="",this.exps=[],this.sums=[]}function n(){this.radix=[],this.power=[]}function e(t){if("string"!=typeof t)throw"syntax.present(typeof s = "+typeof t+")";var n=i().iter(t),e=[];do{for(var r=!1;n.length>0&&n[0].flag==i().FLAG.O;)n.shift().inv&&(r=!r);var a=s(n);a&&(r&&a.fact.unshift(-1),e.push(a))}while(n.length>0);return l(e),e}function r(t){var n="";if(t.length){n+=t[0].string();for(var e=1;e<t.length;e++){var r=t[e].fact.reduce(function(t,n){return t*n},1),i=t[e].string();n+=0>r?i:"+"+i}}return n}function i(){return Slang._mathslang.lexical}function a(t){}function s(r){for(var a=new t;r.length>0;)switch(r[0].flag){case i().FLAG.N:var s=parseFloat(r[0].code);if(r.shift().inv){if(0==s)throw"`pluckQ' divided by 0.";s=1/s}a.fact.push(s);break;case i().FLAG.X:var f=r[0].code;if(r.shift().inv){var l=new n;l.radix.push(c(f)),l.power.push(o(-1)),a.exps.push(l)}else a.imag+=f;break;case i().FLAG.E:var l=new n;r[0].inv,l.radix=e(r.shift().code),l.power=u(r),a.exps.push(l);break;case i().FLAG.L:var g=e(r[0].code);if(r.shift().inv){var l=new n;l.radix=g,l.power.push(o(-1)),a.exps.push(l)}else a.sums.push(g);break;case i().FLAG.O:default:return m(a)?null:a}return m(a)?null:a}function u(t){if(!(t.length>0))throw"`pluckT' without any token.";switch(t[0].flag){case i().FLAG.N:return[o(t.shift().code)];case i().FLAG.X:return[c(t.shift().code)];case i().FLAG.E:var r=new n;if(t[0].inv)throw"`pluckT("+t[0].code+"..)' illegal `inv'";return r.radix=e(t.shift().code),r.power=u(t,!0),[f(r)];case i().FLAG.L:return e(t.shift().code);case i().FLAG.O:t.shift();var a=u(t);return a.forEach(function(t){t.fact.push(-1)}),a;default:throw"`pluckT' invalid `flag=?'."}}function o(n){var e=new t;return e.fact.push(n),e}function c(n){var e=new t;return"string"!=typeof n?(a("not a string"),e):(e.imag=n,e)}function f(n){var e=new t;return"E"!=typeof n?(a("not a E"),e):(e.exps.push(n),e)}function l(t){t.forEach(function(t){t.sums.forEach(function(t){l(t)}),t.fact.sort(function(t,n){return t-n}),t.imag=function(t){return t.split("").sort(function(t,n){return t.charCodeAt(0)-n.charCodeAt(0)}).reduce(function(t,n){return t+n},"")}(t.imag),t.exps.sort(function(t,n){return h(t)-h(n)}),t.sums.sort(function(t,n){return g(t)-g(n)})}),t.sort(function(t,n){return function(t,n){for(var e=Math.min(t.length,n.length),r=0;e>r;r++){if(t[r]<n[r])return-1;if(t[r]>n[r])return 1}return t.length-n.length}(t.imag,n.imag)})}function g(t){return t.reduce(function(t,n){return t+p(n)},0)}function h(t){return Math.pow(16536421.3572347+g(t.radix),g(t.power))}function p(t){return t.fact.reduce(function(t,n){return t*n},1)*function(t){for(var n=1,e=0;e<t.length;e++)n*=t.charCodeAt(0);return n}(t.imag)*t.exps.reduce(function(t,n){return t*h(n)},1)*t.sums.reduce(function(t,n){return t*g(n)},1)}function m(t){return 0==t.fact.length&&0==t.imag.length&&0==t.exps.length&&0==t.sums.length}return t.prototype.string=function(){var t=this,n="";if(t.fact.length){n+=t.fact[0];for(var e=1;e<t.fact.length;e++)n+="*"+t.fact[e]}return n+=t.imag,n+=t.exps.reduce(function(t,n){return t+n.string()},""),n+=t.sums.reduce(function(t,n){return t+"("+r(n)+")"},"")},n.prototype.string=function(){return"("+r(this.radix)+")^("+r(this.power)+")"},{present:e,string:r}}(),window.Slang._mathslang=window.Slang._mathslang||{},Slang._mathslang.vec=function(){function t(t,e){return t=JSON.parse(t),e=JSON.parse(e),JSON.stringify(n(t))===JSON.stringify(n(e))}function n(t){var n=Math.sqrt(t.reduce(function(t,n){return t+n*n},0));return t.map(function(t){return t/n})}return{compare:t}}();