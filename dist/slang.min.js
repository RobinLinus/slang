"use strict";var Slang=Slang||{};Slang.hausdorffslang=function(){function n(n,t,e,u,a){var i=s(n,t,e,u,a);return 1-Math.max(r(i.X,i.Y),r(i.Y,i.X))}function t(n,t){var e=n.x-t.x,r=n.y-t.y;return Math.sqrt(e*e+r*r)}function e(n,e){return e.reduce(function(e,r){var u=t(n,r);return e>u?u:e},1/0)}function r(n,t){return n.reduce(function(n,r){var u=e(r,t);return u>n?u:n},0)}function u(n){var t=n.reduce(function(n,t){return{x0:n.x0+t.x,y0:n.y0+t.y}},{x0:0,y0:0});return t.x0/=n.length,t.y0/=n.length,t}function a(n,t,e,r){var u=e?t.x0:0,a=r?t.y0:0;return n.map(function(n){return{x:n.x-u,y:n.y-a}})}function i(n){return n.reduce(function(n,t){return{xmax:Math.max(t.x,n.xmax),xmin:Math.min(t.x,n.xmin),ymax:Math.max(t.y,n.ymax),ymin:Math.min(t.y,n.ymin)}},{xmax:-(1/0),ymax:-(1/0),xmin:1/0,ymin:1/0})}function o(n,t,e,r){var u=Math.abs(t.xmax-t.xmin),a=Math.abs(e.xmax-e.xmin),i=Math.abs(t.ymax-t.ymin),o=Math.abs(e.ymax-e.ymin),s=a/u,c=o/i,f=2*s*c/(s+c);return n.map(function(n){return{x:r.x0+(r.x0-n.x)/f,y:r.y0+(r.y0-n.y)/f}})}function s(n,t,e,r,s){if(e||r||s){var c=u(n),f=u(t);if(s){var l=i(n),g=i(t);t=o(t,l,g,f)}(e||r)&&(n=a(n,c,e,r),t=a(t,f,e,r))}return{X:n,Y:t}}return{compare:n}}();var Slang=Slang||{};Slang.colorslang=function(){function n(n,e){return n===t(e)}function t(n){return"#"+((1<<24)+(n[0]<<16)+(n[1]<<8)+n[2]).toString(16).slice(1)}return{compare:n}}();var Slang=Slang||{};Slang.langslang=function(){function n(n,e){return Slang.logicslang.compare(n,e,t)}function t(n,t){if(n=n.trim(),t=t.trim(),0!==n.indexOf("#"))return n===t;var u=n.substr(1,n.indexOf(" ")-1);return n=n.substr(n.indexOf(" ")+1),"typo"===u?e(r(n),r(t)):"nocase"===u?r(n)===r(t):"regex"===u?(n=new RegExp(n),n.test(t)):void 0}function e(n,t){var e=Slang.langslang._damerauLevenshtein(n,t);return e<Math.ceil(Math.sqrt(n.length)-1)}function r(n){return n.toLowerCase()}return{compare:n}}(),Slang.langslang._damerauLevenshtein=function(n,t){var e=[];if(n==t)return 0;if(0==n.length)return t.length;if(0==t.length)return n.length;for(var r=0;r<n.length+1;r++){e[r]=[];for(var u=0;u<t.length+1;u++)0==r||0==u?e[r][u]=Math.max(r,u):(e[r][u]=Math.min(e[r-1][u]+1,e[r][u-1]+1,e[r-1][u-1]+(n[r-1]==t[u-1]?0:1)),u>1&&r>1&&n[r-1]==t[u-2]&&n[r-2]==t[u-1]&&(e[r][u]=Math.min(e[r][u],e[r-2][u-2]+1)))}return e[n.length][t.length]},window.Slang=window.Slang||{},window.Slang.logicslang={compare:function(n,t,e,r){if("object"==typeof t)for(var u in t){var a=new RegExp("@"+u,"g");n=n.replace(a,t[u])}var i=new LogicParser(e);return i.compare(n,t,r)}};var LogicParser=function(n){function t(n){var t=[];return t=n.split(/(#and|#or|#not|<&|&|<|>)/),t=t.map(function(n){return n.trim()}),t=t.filter(function(n){return n.length>0})}function e(){if("#not"==u[0])return u.shift(),!r();var n=r();if("#and"===u[0]||"#or"===u[0]){var t=u.shift(),e=r();return"#and"===t?n&&e:n||e}return n}function r(){var t=u.shift(),r="";if("<"==t){r=e();var s=u.shift();if(">"!=s)throw o;return r}if("<&"==t){var c=a;a=u.shift();var f=u.shift();if("&"!=f)throw o;r=e();var s=u.shift();if(">"!=s)throw o;return a=c,r}if(">"==t)throw o;return n(t,a,i)}var u=[],a="",i=void 0,o="ERROR: Mismatched parentheses";this.compare=function(n,r,o){return u=t(n),a=r,i=o,e()}};window.Slang=window.Slang||{},window.Slang.mathslang={},window.Slang.mathslang.compare=function(n,t,e){return Slang.logicslang.compare(n,t,this._compare,e)},window.Slang.mathslang.extractUnit=function(n){return Slang._mathslang.impl.extractUnit(n)},window.Slang.mathslang._compare=function(n,t,e){t+="",n+="";if(t=t.trim(),n=n.trim(),0===n.indexOf("#")){var r=n.substr(1,n.indexOf(" ")-1);switch(n=n.substr(n.indexOf(" ")+1),r){case"equals":return Slang._mathslang.impl.match(n,t,e);case"identic":return Slang._mathslang.impl.matchSyntax(n,t);case"approx":var u=n.split("#epsilon");return Slang._mathslang.impl.matchApprox(u[0],t,u[1],e);case"lt":return Number.parseFloat(t)<Number.parseFloat(n);case"leq":return Number.parseFloat(t)<=Number.parseFloat(n);case"gt":return Number.parseFloat(t)>Number.parseFloat(n);case"geq":return Number.parseFloat(t)>=Number.parseFloat(n);default:return n===t}}},window.Slang=window.Slang||{},window.Slang._mathslang=window.Slang._mathslang||{},window.Slang._mathslang.imaginary=function(){function n(n){var t={};return Object.keys(n).sort(function(n,t){return n.charCodeAt(0)-t.charCodeAt(0)}).forEach(function(e){t[e]=n[e]}),t}function t(n,t){Object.keys(t).forEach(function(e){n[e]?n[e]+=t[e]:n[e]=t[e],n[e]||delete n[e]})}function e(n){Object.keys(n).forEach(function(t){delete n[t]})}function r(n,t){Object.keys(n).forEach(function(e){t?n[e]*=t:delete n[e]})}function u(n,t){return JSON.stringify(n)==JSON.stringify(t)}function a(n){return 0==Object.keys(n).length}function i(n,t){for(var e=Object.keys(n),r=Object.keys(t),u=Math.min(e.length,r.length),a=0;u>a;a++){if(e[a]<r[a])return-1;if(e[a]>r[a])return 1}var i=e.length-r.length;if(i)return i;for(var a=0;u>a;a++)if(i=n[e[a]]-t[r[a]])return i;return 0}function o(n,t){for(var e=Math.min(n.length,t.length),r=0;e>r;r++){if(n[r]<t[r])return-1;if(n[r]>t[r])return 1}return n.length-t.length}function s(n){return n.split("").sort(function(n,t){return n.charCodeAt(0)-t.charCodeAt(0)}).reduce(function(n,t){return n+t},"")}function c(n){for(var t={},e=0;e<n.length;e++){var r=n[e];t[r]?t[r]++:t[r]=1}return t}function f(n){for(var t=1,e=0;e<n.length;e++)t*=n.charCodeAt(0);return t}function l(n){return Object.keys(n).length}function g(n){return Object.keys(n).reduce(function(t,e){return t[e]=n[e],t},{})}function h(n){return Object.keys(n).reduce(function(t,e){var r=n[e];return t+(1==r?e:e+"^"+r)},"")}return{sort:n,insert:t,clear:e,pow:r,equals:u,empty:a,sortFunc:i,strSortFunc:o,strSort:s,strParse:c,strValue:f,len:l,clone:g,string:h}}(),window.Slang=window.Slang||{},window.Slang._mathslang=window.Slang._mathslang||{},window.Slang._mathslang.impl=function(){function n(){return Slang._mathslang.lexical}function t(){return Slang._mathslang.syntax}function e(){return Slang._mathslang.semantix}function r(r,u,a){try{return a&&(r=n().replace_units(r,a),u=n().replace_units(u,a)),n().empty(r)||n().empty(u)?!1:(r=t().present(r),u=t().present(u),t().string(r)==t().string(u)?!0:(r=e().represent(r),u=e().represent(u),r.string()==u.string()?!0:r.calc()==u.calc()?!0:(r=r.simplify(3),u=u.simplify(3),r.string()==u.string()?!0:!1)))}catch(i){return!1}}function u(e,r,u){try{return u&&(e=n().replace_units(e,u),r=n().replace_units(r,u)),n().empty(e)||n().empty(r)?!1:(e=t().present(e),r=t().present(r),t().string(e)==t().string(r)?!0:!1)}catch(a){return!1}}function a(t,r,u,a){try{if("number"==typeof t&&(t=""+t),"number"==typeof r&&(r=""+r),"string"==typeof u&&(u=parseFloat(u)),a&&(t=n().replace_units(t,a),r=n().replace_units(r,a)),n().empty(t)||n().empty(r))return!1;t=e().present(t),r=e().present(r);var i=e().clone(t),o=e().clone(r);return e().free_const(i),e().free_const(o),i=i.simplify(3),o=o.simplify(3),i.string()!=o.string()?!1:(e().free_imag(t),e().free_imag(r),t=t.simplify(2),r=r.simplify(2),t=t.calc(),r=r.calc(),isNaN(t)||isNaN(r)?!1:Math.abs(t-r)<=u+2.31e-16?!0:!1)}catch(u){return!1}}function i(t,r){function u(n,t,e){return n.substr(0,t)+e+n.substr(t+e.length)}r&&(t=n().replace_units(t,r)),t=e().present(t),t=t.simplify(3),e().free_const(t),t=e().string_imag(t);for(var a=0;a<t.length;++a)if(a>0&&"^"==t[a-1]&&"-"==t[a]){for(var i=0;" "==t[a-2-i];)++i;if(")"==t[a-2-i]){for(var o=1,s=1;s>0&&a-2-i-o>=0;){var c=t[a-2-i-o];s+="("==c?-1:")"==c?1:0,++o}for(;o>=0;)--o}else t=u(t,a-0,"^"),t=u(t,a-1,t[a-2]),t=u(t,a-2,"/")}return t=t.replace(/1/g,"")}return{match:r,matchSyntax:u,matchApprox:a,extractUnit:i}}(),window.Slang=window.Slang||{},window.Slang._mathslang=window.Slang._mathslang||{},window.Slang._mathslang.lexical=function(){function n(n,t){this.flag=n,this.code=t,this.inv=!1}function t(t){t=o(t);for(var e=[],r=a(t).split("");r.length>0;){var u=0,g="";if(c.test(r[0])){do r.shift();while(c.test(r[0]))}else if(f[0].test(r[0])){r.shift(),g="",u=s.L;for(var h=1,p="";h>0;){if(g+=p,0==r.length)throw")";p=r.shift(),h+=f[0].test(p)?1:f[1].test(p)?-1:0}e.push(new n(u,g))}else{for(;u<l.length;){var m=l[u];if(m.test(r[0]))do g=g.concat(r.shift());while(m.plu&&m.test(r[0]));g.length>0?(e.push(new n(u,g)),u=l.length):u++}if(0==g.length)throw r.shift()}}return i(e)}function e(n){for(var t=0;t<n.length;t++)if(!c.test(n[t]))return!1;return!0}function r(n,t){function e(n,t,e){return n.substr(0,t)+e+n.substr(t+e.length)}var r=!0,u=!0;t.split(" ").forEach(function(t){switch(t){case"weight":n=n.replace(/ton/g,"(�1000000g)"),u&&(n=n.replace(/t/g,"(�1000000g)")),n=n.replace(/Kg/g,"(�1000g)"),n=n.replace(/kg/g,"(�1000g)"),n=n.replace(/mg/g,"(�0.001g)");break;case"distance":n=n.replace(/Km/g,"(� 1000m)"),n=n.replace(/km/g,"(� 1000m)"),n=n.replace(/dm/g,"(� 0.100m)"),n=n.replace(/cm/g,"(� 0.010m)"),n=n.replace(/mm/g,"(� 0.001m)"),n=n.replace(/min/g,"(� 60s)"),n=n.replace(/m/g,"(� m)"),r=!1;break;case"time":n=n.replace(/min/g,"(� 60s)"),r&&(n=n.replace(/m/g,"(� 60s)")),n=n.replace(/h/g,"(� 3600s)"),n=n.replace(/s/g,"(� s)"),u=!1;break;default:throw"mathslang does not support unit `"+t+"'"}});for(var a=0;a<n.length;++a)if("�"==n[a]){if(a&&"("!=n[a-1])throw n[a-1]+"� instead of (�";var i=2;do{for(;" "==n[a-i];)++i;if(a>=i&&")"==n[a-i]){for(var o=1;o>0&&a>i;){var s=n[a-++i];o+=")"==s?1:"("==s?-1:0}++i}for(;" "==n[a-i];)++i;for(;a>=i&&/^[0-9a-zA-Z]$/.test(n[a-i]);)++i;for(;" "==n[a-i];)++i}while(a>=i&&")"==n[a-i]);if("/"==n[a-i]){for(var c=0;i>c+2;++c)n=e(n,a-c,n[a-c-2]);n=e(n,a-i+1," "),n=e(n,a-i+2,"(")}}return n.replace(/\�/g,"")}function u(n,t){this.exp=t,this.plu=n,this.test=function(n){return this.exp.test(n)}}function a(n){return n=n.replace(/�/g,"^2"),n=n.replace(/�/g,"^3"),n=n.replace(/\u00B2/g,"^2"),n=n.replace(/\u00B3/g,"^3"),n=n.replace(/,/g,".")}function i(n){var t=[],e=!1;for(var r in n){if(n[r].flag==s.O)switch(n[r].code){case"-":n[r].inv=!n[r].inv;case"+":break;case"/":e=!0;case"*":continue;default:throw"operator `"+n[r].code+"' has not been implemented."}else if(n[r].flag==s.E){if(0==t.length)throw"radix ahead `"+n[r].code+"' is undefined.";var u=t.pop();if(u.flag==s.O)throw"radix is not allowed to be an `"+u.code+"' operator.";n[r].code=u.code,n[r].inv=u.inv}else e&&(n[r].inv=!(e=!1));t.push(n[r])}return t}function o(n){for(var t={"Sqrt(�)":"�^.5","sqrt(�)":"�^.5","root(�)":"�^.5","wurzel(�)":"�^.5","Wurzel(�)":"�^.5","R007(�)":"�^.5"},e=Object.keys(t),r=0;r<n.length;++r)for(var u=0;u<e.length;++u)for(var a=0;e[u][a]==n[r+a];)if(++a,"�"==e[u][a]){for(var i="",o=0,s="";(s=n[r+a+o])!=e[u][a+1];)i+=s,++o;n=n.substr(0,r)+"("+t[e[u]]+n.substr(r+a+o,n.length),n=n.replace("�","("+i+")")}return n}var s={O:0,E:1,X:2,N:3,L:7},c=new u(!0,/^\s$/),f=[new u(!1,/^\(|\[|\{$/),new u(!1,/^\)|\]|\}$/)],l=[new u(!1,/^\+|\-|\*|\/$/),new u(!1,/^\^$/),new u(!1,/^[a-zA-Z]$/),new u(!0,/^[0-9]|\,|\.$/)];return{FLAG:s,T:n,iter:t,empty:e,replace_units:r}}(),window.Slang=window.Slang||{},window.Slang._mathslang=window.Slang._mathslang||{},window.Slang._mathslang.semantix=function(){function n(n,t,e){this.fact=void 0!==n?n:1,this.imag=void 0!==t?t:{},this.sums=void 0!==e?e:[]}function t(n,t,e){this.offset=void 0!==n?n:0,this.queues=void 0!==t&&t.length?t:[],this.expont=void 0!==e?e:null}function e(){return Slang._mathslang.imaginary}function r(){return Slang._mathslang.syntax}function u(n){if("string"!=typeof n)throw"`Seman.present(string)' got `"+typeof n+"' instead of `string'";var t=r().present(n);return a(t)}function a(n){var e=new t;return n.forEach(function(n){var t=i(n);o(t)?e.offset+=t.fact:e.queues.push(t)}),e=s(e)}function i(r){var u=new n;return u.fact=r.fact?r.fact.reduce(function(n,t){return n*t},1):1,u.imag=e().strParse(r.imag),r.exps.forEach(function(e){var r=a(e.radix),i=a(e.power),o=r.expont;if(r.expont=i,o){var s=new t;r.expont=o,s.expont=i,s.queues.push(new n(1,{},[r])),r=s}u.sums.push(r)}),r.sums.forEach(function(n){var t=a(n);u.sums.push(t)}),u}function o(n){return 0==e().len(n.imag)&&0==n.sums.length}function s(n){var t=n.expont?n.expont.calc():NaN;return 0!=n.offset||1!=n.queues.length||1!=n.queues[0].fact||0!=n.queues[0].sums||isNaN(t)?n.queues.forEach(function(n){return n.sums.map(function(n){return s(n)})}):(e().pow(n.queues[0].imag,t),n.expont=null),0!=n.offset||1!=n.queues.length||n.expont||1!=n.queues[0].fact||0!=e().len(n.queues[0].imag)||1!=n.queues[0].sums.length?n:s(n.queues[0].sums[0])}function c(n){var t=n.offset+n.queues.reduce(function(n,t){return n+f(t)},0);return n.expont?Math.pow(t,c(n.expont)):t}function f(n){return Object.keys(n.imag).length>0?NaN:n.fact*n.sums.reduce(function(n,t){return n*c(t)},1)}function l(n){return n.expont?0==n.offset&&1==n.queues.length?!0:0!=n.offset&&0==n.queues.length:!1}function g(t,e){return new n(Math.pow(t.fact,e),Object.keys(t.imag).reduce(function(n,r){return n[r]=t.imag[r]*e,n},{}))}function h(n){return 0==n.offset&&null==n.expont&&n.queues.length?!n.queues.some(f):!1}function p(n){return n.fact*n.sums.reduce(function(n,t){return n*t.calc()},1)==1&&e().empty(n.imag)}function m(n){var t=n.expont?!0:!1;return n.queues.reduce(function(n,t){var e=t.string();return n+(t.fact<0?e:"+"+e)},(t?"(":"")+n.offset)+(t?")^("+n.expont.string()+")":"")}function w(n){return n.sums.reduce(function(n,t){return n+"("+t.string()+")"},""+n.fact+e().string(n.imag))}function v(n){var e=new t;return e.offset=n.offset,e.queues=n.queues.map(d),e.expont=n.expont?v(n.expont):null,e}function d(t){var r=new n;return r.fact=t.fact,r.imag=e().clone(t.imag),r.sums=t.sums.map(v),r}function x(n,t){do n=n.expand(),n=n.combine(),n=n.expow();while(--t>0);return n}function y(n){for(var t=0;t<n.queues.length;){var r=S(n.queues[t]);if(e().clear(n.queues[t].imag),n.queues[t].fact=1,n.queues[t].ident()){if(r.expont)throw"`expand': `s0.expont' must be `null'.";n.queues.splice(t,1),n.offset+=r.offset,n.queues=r.queues.concat(n.queues),t+=r.queues.length}else 1!=r.calc()&&n.queues[t].sums.push(r),t++}}function S(r){for(var u=new t(0,[new n(r.fact,e().clone(r.imag))]),a=0;a<r.sums.length;)y(r.sums[a]),null==r.sums[a].expont?(u=q(u,r.sums[a]),r.sums.splice(a,1)):a++;return u}function q(r,u){if(null!=r.expont)throw"`expansion': `s0.expont != null'";if(null!=u.expont)throw"`expansion': `s1.expont != null'";var a=r.offset*u.offset,i=r.queues.map(function(t){return new n(u.offset*t.fact,e().clone(t.imag),t.sums)}).concat(u.queues.map(function(t){return new n(r.offset*t.fact,e().clone(t.imag),t.sums)}));return r.queues.forEach(function(t){u.queues.forEach(function(r){var u={};e().insert(u,t.imag),e().insert(u,r.imag),i.push(new n(t.fact*r.fact,e().sort(u),t.sums.concat(r.sums)))})}),r=new t(a,i.filter(function(n){return 0!=n.fact}))}function b(n){var r=n.offset,u=[],a=void 0,i=n.expont;return i&&(i=b(n.expont)),n.queues.filter(function(n){var t=f(n);return isNaN(t)?!0:(r+=t,!1)}).map(function(n){return _(n),n}).sort(function(n,t){return-e().sortFunc(n.imag,t.imag)}).forEach(function(n){void 0!=a&&e().equals(a.imag,n.imag)&&0==a.sums.length&&0==n.sums.length?u[0].fact+=n.fact:(u.unshift(n),a=n)}),u=u.filter(function(n){return 0!=n.fact}),n=s(new t(r,u,i))}function _(n){var t,e,r,u=[];t=n.sums.reduce(function(n,t,e){t=t.combine(t);var r=t.expont;t.expont=null;var u=m(t);return t.expont=r,n[u]?n[u].push(e):n[u]=[e],n},new Object),e=Object.keys(t);for(var a=0;a<e.length;a++)r=t[e[a]],r.length>1&&(u=u.concat(k(n.sums,r)));u.sort(function(n,t){return t-n}).forEach(function(t){n.sums.splice(t,1)})}function k(e,r){if(r.length<2)throw"`combineE': "+r.length+"/2 indices";var u=[],a=new t,i=new t;for(i.offset=e[r[0]].offset,i.queues=e[r[0]].queues;r.length;){var o=e[r[0]].expont;o?o.expont?a.queues.push(new n(1,{},[o])):(a.offset+=o.offset,a.queues=a.queues.concat(o.queues)):a.offset++,u.push(r[0]),r.splice(0,1)}return i.expont=a,e.push(i),u}function E(e){e=N(e);var r=e.expont?e.expont.calc():NaN;if(isNaN(r))e.expont&&e.expont.expont;else{for(var u=[];r>1;){var a=new t;a.offset=e.offset,a.queues=e.queues.map(d),u.push(a),r--}e.expont=1==r?null:new t(r),u.length&&(u.unshift(e),e=new t,e.queues.push(new n(1,{},u)))}return e.queues.forEach(function(n){n.sums=n.sums.map(E)}),e=s(e)}function N(n){if(0==n.offset&&1==n.queues.length&&n.expont){for(var r=n.expont,u=n.queues[0],n=new t(0,[u]),a=0;a<u.sums.length;a++){var i=u.sums[a].expont,o=v(r);u.sums[a].expont=q(i,o)}var s=r.calc();isNaN(s)?(u.sums.push(new t(u.fact,u.imag,v(r))),u.fact=1,u.imag={}):(u.fact=Math.pow(u.fact,s),e().pow(u.imag,s))}return n}function O(n){n.queues.forEach(function(n){n.imag="",n.sums.forEach(function(n){O(n)})}),n.expont&&O(n.expont)}function F(n){n.offset=0,n.queues.forEach(function(n){n.fact=1,n.sums.forEach(function(n){F(n)})}),n.expont&&F(n.expont)}function M(n){for(var t="",e=0;e<n.queues.length;++e){var r=n.queues[e];t=Object.keys(r.imag).reduce(function(n,t){var e=r.imag[t];return n+(1==e?t:-1==e?"1/"+t:t+"^"+e)},t),r.sums.forEach(function(n){t+="("+M(n)+")"}),e+1<n.queues.length&&(t+=" + ")}return n.expont?t+"^"+M(n.expont):t}return n.prototype.calc=function(){return f(this)},n.prototype.ident=function(){return p(this)},n.prototype.string=function(){return w(this)},n.prototype.pow=function(n){return g(this,n)},t.prototype.calc=function(){return c(this)},t.prototype.expand=function(){return y(this),this},t.prototype.combine=function(){return b(this)},t.prototype.expow=function(){return E(this)},t.prototype.akinQ=function(){return l(this)},t.prototype.ident=function(){return h(this)},t.prototype.string=function(){return m(this)},t.prototype.simplify=function(n){return x(this,n)},{present:u,represent:a,clone:v,free_imag:O,free_const:F,simplify:x,string_imag:M}}(),window.Slang=window.Slang||{},window.Slang._mathslang=window.Slang._mathslang||{},window.Slang._mathslang.syntax=function(){function n(){this.fact=[],this.imag="",this.exps=[],this.sums=[]}function t(){this.radix=[],this.power=[]}function e(){return Slang._mathslang.lexical}function r(n){if("string"!=typeof n)throw"syntax.present(typeof s = "+typeof n+")";var t=e().iter(n),r=[];do{for(var a=!1;t.length>0&&t[0].flag==e().FLAG.O;)t.shift().inv&&(a=!a);var i=u(t);i&&(a&&i.fact.unshift(-1),r.push(i))}while(t.length>0);return c(r),r}function u(u){for(var s=new n;u.length>0;)switch(u[0].flag){case e().FLAG.N:var c=parseFloat(u[0].code);if(u.shift().inv){if(0==c)throw"`pluckQ' divided by 0.";c=1/c}s.fact.push(c);break;case e().FLAG.X:var f=u[0].code;if(u.shift().inv){var l=new t;l.radix.push(o(f)),l.power.push(i(-1)),s.exps.push(l)}else s.imag+=f;break;case e().FLAG.E:var l=new t;u[0].inv,l.radix=r(u.shift().code),l.power=a(u),s.exps.push(l);break;case e().FLAG.L:var g=r(u[0].code);if(u.shift().inv){var l=new t;l.radix=g,l.power.push(i(-1)),s.exps.push(l)}else s.sums.push(g);break;case e().FLAG.O:default:return p(s)?null:s}return p(s)?null:s}function a(n){if(!(n.length>0))throw"`pluckT' without any token.";switch(n[0].flag){case e().FLAG.N:return[i(n.shift().code)];case e().FLAG.X:return[o(n.shift().code)];case e().FLAG.E:var u=new t;if(n[0].inv)throw"`pluckT("+n[0].code+"..)' illegal `inv'";return u.radix=r(n.shift().code),u.power=a(n,!0),[s(u)];case e().FLAG.L:return r(n.shift().code);case e().FLAG.O:n.shift();var c=a(n);return c.forEach(function(n){n.fact.push(-1)}),c;default:throw"`pluckT' invalid `flag=?'."}}function i(t){var e=new n;return e.fact.push(t),e}function o(t){var e=new n;return"string"!=typeof t?e:(e.imag=t,e)}function s(t){var e=new n;return"E"!=typeof t?e:(e.exps.push(t),e)}function c(n){n.forEach(function(n){f(n)}),n.sort(function(n,t){return Slang._mathslang.imaginary.strSortFunc(n.imag,t.imag)})}function f(n){n.sums.forEach(function(n){c(n)}),n.fact.sort(function(n,t){return n-t}),n.imag=Slang._mathslang.imaginary.strSort(n.imag),n.exps.sort(function(n,t){return g(n)-g(t)}),n.sums.sort(function(n,t){return l(n)-l(t)})}function l(n){return n.reduce(function(n,t){return n+h(t)},0)}function g(n){return Math.pow(16536421.3572347+l(n.radix),l(n.power))}function h(n){return n.fact.reduce(function(n,t){return n*t},1)*Slang._mathslang.imaginary.strValue(n.imag)*n.exps.reduce(function(n,t){return n*g(t)},1)*n.sums.reduce(function(n,t){return n*l(t)},1)}function p(n){return 0==n.fact.length&&0==n.imag.length&&0==n.exps.length&&0==n.sums.length}function m(n){var t="";if(n.length){t+=w(n[0]);for(var e=1;e<n.length;e++){var r=n[e].fact.reduce(function(n,t){return n*t},1),u=w(n[e]);t+=0>r?u:"+"+u}}return t}function w(n){var t="";if(n.fact.length){t+=n.fact[0];for(var e=1;e<n.fact.length;e++)t+="*"+n.fact[e]}return t+=n.imag,t+=n.exps.reduce(function(n,t){return n+v(t)},""),t+=n.sums.reduce(function(n,t){return n+"("+m(t)+")"},"")}function v(n){return"("+m(n.radix)+")^("+m(n.power)+")"}return{Q:n,E:t,present:r,pluckQ:u,N2Q:i,X2Q:o,sort:c,emptyQ:p,string:m,stringQ:w}}();