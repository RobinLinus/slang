"use strict";var Slang=Slang||{};Slang.colorslang=function(){function n(n,e){return n===t(e)}function t(n){return"#"+((1<<24)+(n[0]<<16)+(n[1]<<8)+n[2]).toString(16).slice(1)}return{compare:n}}();var Slang=Slang||{};Slang.hausdorffslang=function(){function n(n,t,e,a,i){var u=o(n,t,e,a,i);return 1-Math.max(r(u.X,u.Y),r(u.Y,u.X))}function t(n,t){var e=n.x-t.x,r=n.y-t.y;return Math.sqrt(e*e+r*r)}function e(n,e){return e.reduce(function(e,r){var a=t(n,r);return e>a?a:e},1/0)}function r(n,t){return n.reduce(function(n,r){var a=e(r,t);return a>n?a:n},0)}function a(n){var t=n.reduce(function(n,t){return{x0:n.x0+t.x,y0:n.y0+t.y}},{x0:0,y0:0});return t.x0/=n.length,t.y0/=n.length,t}function i(n,t,e,r){var a=e?t.x0:0,i=r?t.y0:0;return n.map(function(n){return{x:n.x-a,y:n.y-i}})}function u(n){return n.reduce(function(n,t){return{xmax:Math.max(t.x,n.xmax),xmin:Math.min(t.x,n.xmin),ymax:Math.max(t.y,n.ymax),ymin:Math.min(t.y,n.ymin)}},{xmax:-(1/0),ymax:-(1/0),xmin:1/0,ymin:1/0})}function s(n,t,e,r){var a=Math.abs(t.xmax-t.xmin),i=Math.abs(e.xmax-e.xmin),u=Math.abs(t.ymax-t.ymin),s=Math.abs(e.ymax-e.ymin),o=i/a,c=s/u,f=2*o*c/(o+c);return n.map(function(n){return{x:r.x0+(r.x0-n.x)/f,y:r.y0+(r.y0-n.y)/f}})}function o(n,t,e,r,o){if(e||r||o){var c=a(n),f=a(t);if(o){var l=u(n),g=u(t);t=s(t,l,g,f)}(e||r)&&(n=i(n,c,e,r),t=i(t,f,e,r))}return{X:n,Y:t}}return{compare:n}}();var Slang=Slang||{};Slang.langslang=function(){function n(n,e){return Slang.logicslang.compare(n,e,t)}function t(n,t){if(n=n.trim(),t=t.trim(),0!==n.indexOf("#"))return n===t;var a=n.substr(1,n.indexOf(" ")-1);return n=n.substr(n.indexOf(" ")+1),"typo"===a?e(r(n),r(t)):"nocase"===a?r(n)===r(t):"regex"===a?(n=new RegExp(n),n.test(t)):void 0}function e(n,t){var e=Slang.langslang._damerauLevenshtein(n,t);return e<Math.ceil(Math.sqrt(n.length)-1)}function r(n){return n.toLowerCase()}return{compare:n}}(),Slang.langslang._damerauLevenshtein=function(n,t){var e=[];if(n==t)return 0;if(0==n.length)return t.length;if(0==t.length)return n.length;for(var r=0;r<n.length+1;r++){e[r]=[];for(var a=0;a<t.length+1;a++)0==r||0==a?e[r][a]=Math.max(r,a):(e[r][a]=Math.min(e[r-1][a]+1,e[r][a-1]+1,e[r-1][a-1]+(n[r-1]==t[a-1]?0:1)),a>1&&r>1&&n[r-1]==t[a-2]&&n[r-2]==t[a-1]&&(e[r][a]=Math.min(e[r][a],e[r-2][a-2]+1)))}return e[n.length][t.length]},window.Slang=window.Slang||{},window.Slang.logicslang={compare:function(n,t,e,r){if("object"==typeof t)for(var a in t){var i=new RegExp("@"+a,"g");n=n.replace(i,t[a])}var u=new LogicParser(e);return u.compare(n,t,r)}};var LogicParser=function(n){function t(n){var t=[];return t=n.split(/(#and|#or|#not|<&|&|<|>)/),t=t.map(function(n){return n.trim()}),t=t.filter(function(n){return n.length>0})}function e(){if("#not"==a[0])return a.shift(),!r();var n=r();if("#and"===a[0]||"#or"===a[0]){var t=a.shift(),e=r();return"#and"===t?n&&e:n||e}return n}function r(){var t=a.shift(),r="";if("<"==t){r=e();var o=a.shift();if(">"!=o)throw s;return r}if("<&"==t){var c=i;i=a.shift();var f=a.shift();if("&"!=f)throw s;r=e();var o=a.shift();if(">"!=o)throw s;return i=c,r}if(">"==t)throw s;return n(t,i,u)}var a=[],i="",u=void 0,s="ERROR: Mismatched parentheses";this.compare=function(n,r,s){return a=t(n),i=r,u=s,e()}};window.Slang=window.Slang||{},window.Slang.mathslang={},window.Slang.mathslang.compare=function(n,t,e){return Slang.logicslang.compare(n,t,this._compare,e)},window.Slang.mathslang.extractUnit=function(n){return Slang._mathslang.impl.extractUnit(n)},window.Slang.mathslang._compare=function(n,t,e){t+="",n+="";if(t=t.trim(),n=n.trim(),0===n.indexOf("#")){var r=n.substr(1,n.indexOf(" ")-1);switch(n=n.substr(n.indexOf(" ")+1),r){case"equals":return Slang._mathslang.impl.match(n,t,e);case"identic":return Slang._mathslang.impl.matchSyntax(n,t);case"approx":var a=n.split("#epsilon");return Slang._mathslang.impl.matchApprox(a[0],t,a[1],e);case"lt":return Number.parseFloat(t)<Number.parseFloat(n);case"leq":return Number.parseFloat(t)<=Number.parseFloat(n);case"gt":return Number.parseFloat(t)>Number.parseFloat(n);case"geq":return Number.parseFloat(t)>=Number.parseFloat(n);default:return n===t}}},window.Slang=window.Slang||{},window.Slang._mathslang=window.Slang._mathslang||{},window.Slang._mathslang.imaginary=function(){function n(n){var t={};return Object.keys(n).sort(function(n,t){return n.charCodeAt(0)-t.charCodeAt(0)}).forEach(function(e){t[e]=n[e]}),t}function t(n,t){Object.keys(t).forEach(function(e){n[e]?n[e]+=t[e]:n[e]=t[e],n[e]||delete n[e]})}function e(n){Object.keys(n).forEach(function(t){delete n[t]})}function r(n,t){Object.keys(n).forEach(function(e){t?n[e]*=t:delete n[e]})}function a(n,t){return JSON.stringify(n)==JSON.stringify(t)}function i(n){return 0==Object.keys(n).length}function u(n,t){for(var e=Object.keys(n),r=Object.keys(t),a=Math.min(e.length,r.length),i=0;a>i;i++){if(e[i]<r[i])return-1;if(e[i]>r[i])return 1}var u=e.length-r.length;if(u)return u;for(var i=0;a>i;i++)if(u=n[e[i]]-t[r[i]])return u;return 0}function s(n,t){for(var e=Math.min(n.length,t.length),r=0;e>r;r++){if(n[r]<t[r])return-1;if(n[r]>t[r])return 1}return n.length-t.length}function o(n){return n.split("").sort(function(n,t){return n.charCodeAt(0)-t.charCodeAt(0)}).reduce(function(n,t){return n+t},"")}function c(n){for(var t={},e=0;e<n.length;e++){var r=n[e];t[r]?t[r]++:t[r]=1}return t}function f(n){for(var t=1,e=0;e<n.length;e++)t*=n.charCodeAt(0);return t}function l(n){return Object.keys(n).length}function g(n){return Object.keys(n).reduce(function(t,e){return t[e]=n[e],t},{})}function h(n){return Object.keys(n).reduce(function(t,e){var r=n[e];return t+(1==r?e:e+"^"+r)},"")}return{sort:n,insert:t,clear:e,pow:r,equals:a,empty:i,sortFunc:u,strSortFunc:s,strSort:o,strParse:c,strValue:f,len:l,clone:g,string:h}}(),window.Slang=window.Slang||{},window.Slang._mathslang=window.Slang._mathslang||{},window.Slang._mathslang.impl=function(){function n(n){}function t(){return Slang._mathslang.lexical}function e(){return Slang._mathslang.syntax}function r(){return Slang._mathslang.semantix}function a(a,i,u){try{return u&&(a=t().replace_units(a,u),i=t().replace_units(i,u)),t().empty(a)||t().empty(i)?!1:(a=e().present(a),i=e().present(i),e().string(a)==e().string(i)?(n("syntax equality: "+e().string(a)+" = "+e().string(i)),!0):(a=r().represent(a),i=r().represent(i),a.string()==i.string()?(n("semantix equality: "+a.string()+" = "+i.string()),!0):a.calc()==i.calc()?(n("constant equality: "+a.string()+" = "+i.string()),!0):(a=a.simplify(3),i=i.simplify(3),a.string()==i.string()?(n("simplify equality: "+a.string()+" = "+i.string()),!0):(n("no semantix equality: "+a.string()+" = "+i.string()),!1))))}catch(s){return!1}}function i(r,a,i){try{return i&&(r=t().replace_units(r,i),a=t().replace_units(a,i)),t().empty(r)||t().empty(a)?!1:(r=e().present(r),a=e().present(a),e().string(r)==e().string(a)?(n("syntax equality: "+e().string(r)+" = "+e().string(a)),!0):(n("no syntax equality: "+e().string(r)+" = "+e().string(a)),!1))}catch(u){return!1}}function u(e,a,i,u){try{if("number"==typeof e&&(e=""+e),"number"==typeof a&&(a=""+a),"string"==typeof i&&(i=parseFloat(i)),u&&(e=t().replace_units(e,u),a=t().replace_units(a,u)),t().empty(e)||t().empty(a))return!1;e=r().present(e),a=r().present(a);var s=e.clone(),o=a.clone();return s.free_const(),o.free_const(),s=s.simplify(3),o=o.simplify(3),s.string()!=o.string()?!1:(e.free_imag(),a.free_imag(),e=e.simplify(2),a=a.simplify(2),e=e.calc(),a=a.calc(),isNaN(e)||isNaN(a)?!1:Math.abs(e-a)<=i+2.31e-16?(n("approx equality: "+e+" = "+a+" (epsilon = "+i+")"),!0):!1)}catch(i){return!1}}function s(n,e){function a(n,t,e){return n.substr(0,t)+e+n.substr(t+e.length)}e&&(n=t().replace_units(n,e)),n=r().present(n),n=n.simplify(3),n.free_const(),n=r().unit(n);for(var i=0;i<n.length;++i)if(i>0&&"^"==n[i-1]&&"-"==n[i]){for(var u=0;" "==n[i-2-u];)++u;if(")"==n[i-2-u]){for(var s=1,o=1;o>0&&i-2-u-s>=0;){var c=n[i-2-u-s];o+="("==c?-1:")"==c?1:0,++s}for(;s>=0;)--s}else n=a(n,i-0,"^"),n=a(n,i-1,n[i-2]),n=a(n,i-2,"/")}return n=n.replace(/1/g,"")}return{match:a,matchSyntax:i,matchApprox:u,extractUnit:s}}(),window.Slang=window.Slang||{},window.Slang._mathslang=window.Slang._mathslang||{},window.Slang._mathslang.lexical=function(){function n(n,t){this.flag=n,this.code=t,this.inv=!1}function t(t){t=s(t);for(var e=[],r=i(t).split("");r.length>0;){var a=0,g="";if(c.test(r[0])){do r.shift();while(c.test(r[0]))}else if(f[0].test(r[0])){r.shift(),g="",a=o.L;for(var h=1,p="";h>0;){if(g+=p,0==r.length)throw")";p=r.shift(),h+=f[0].test(p)?1:f[1].test(p)?-1:0}e.push(new n(a,g))}else{for(;a<l.length;){var m=l[a];if(m.test(r[0]))do g=g.concat(r.shift());while(m.plu&&m.test(r[0]));g.length>0?(e.push(new n(a,g)),a=l.length):a++}if(0==g.length)throw r.shift()}}return u(e)}function e(n){for(var t=0;t<n.length;t++)if(!c.test(n[t]))return!1;return!0}function r(n,t){function e(n,t,e){return n.substr(0,t)+e+n.substr(t+e.length)}var r=!0,a=!0;t.split(" ").forEach(function(t){switch(t){case"weight":n=n.replace(/ton/g,"(�1000000g)"),a&&(n=n.replace(/t/g,"(�1000000g)")),n=n.replace(/Kg/g,"(�1000g)"),n=n.replace(/kg/g,"(�1000g)"),n=n.replace(/mg/g,"(�0.001g)");break;case"distance":n=n.replace(/Km/g,"(� 1000m)"),n=n.replace(/km/g,"(� 1000m)"),n=n.replace(/dm/g,"(� 0.100m)"),n=n.replace(/cm/g,"(� 0.010m)"),n=n.replace(/mm/g,"(� 0.001m)"),n=n.replace(/min/g,"(� 60s)"),n=n.replace(/m/g,"(� m)"),r=!1;break;case"time":n=n.replace(/min/g,"(� 60s)"),r&&(n=n.replace(/m/g,"(� 60s)")),n=n.replace(/h/g,"(� 3600s)"),n=n.replace(/s/g,"(� s)"),a=!1;break;default:throw"mathslang does not support unit `"+t+"'"}});for(var i=0;i<n.length;++i)if("�"==n[i]){if(i&&"("!=n[i-1])throw n[i-1]+"� instead of (�";var u=2;do{for(;" "==n[i-u];)++u;if(i>=u&&")"==n[i-u]){for(var s=1;s>0&&i>u;){var o=n[i-++u];s+=")"==o?1:"("==o?-1:0}++u}for(;" "==n[i-u];)++u;for(;i>=u&&/^[0-9a-zA-Z]$/.test(n[i-u]);)++u;for(;" "==n[i-u];)++u}while(i>=u&&")"==n[i-u]);if("/"==n[i-u]){for(var c=0;u>c+2;++c)n=e(n,i-c,n[i-c-2]);n=e(n,i-u+1," "),n=e(n,i-u+2,"(")}}return n.replace(/\�/g,"")}function a(n,t){this.exp=t,this.plu=n,this.test=function(n){return this.exp.test(n)}}function i(n){return n=n.replace(/�/g,"^2"),n=n.replace(/�/g,"^3"),n=n.replace(/\u00B2/g,"^2"),n=n.replace(/\u00B3/g,"^3"),n=n.replace(/,/g,".")}function u(n){var t=[],e=!1;for(var r in n){if(n[r].flag==o.O)switch(n[r].code){case"-":n[r].inv=!n[r].inv;case"+":break;case"/":e=!0;case"*":continue;default:throw"operator `"+n[r].code+"' has not been implemented."}else if(n[r].flag==o.E){if(0==t.length)throw"radix ahead `"+n[r].code+"' is undefined.";var a=t.pop();if(a.flag==o.O)throw"radix is not allowed to be an `"+a.code+"' operator.";n[r].code=a.code,n[r].inv=a.inv}else e&&(n[r].inv=!(e=!1));t.push(n[r])}return t}function s(n){for(var t={"Sqrt(�)":"�^.5","sqrt(�)":"�^.5","root(�)":"�^.5","wurzel(�)":"�^.5","Wurzel(�)":"�^.5","R007(�)":"�^.5"},e=Object.keys(t),r=0;r<n.length;++r)for(var a=0;a<e.length;++a)for(var i=0;e[a][i]==n[r+i];)if(++i,"�"==e[a][i]){for(var u="",s=0,o="";(o=n[r+i+s])!=e[a][i+1];)u+=o,++s;n=n.substr(0,r)+"("+t[e[a]]+n.substr(r+i+s,n.length),n=n.replace("�","("+u+")")}return n}var o={O:0,E:1,X:2,N:3,L:7},c=new a(!0,/^\s$/),f=[new a(!1,/^\(|\[|\{$/),new a(!1,/^\)|\]|\}$/)],l=[new a(!1,/^\+|\-|\*|\/$/),new a(!1,/^\^$/),new a(!1,/^[a-zA-Z]$/),new a(!0,/^[0-9]|\,|\.$/)];return{FLAG:o,T:n,iter:t,empty:e,replace_units:r}}(),window.Slang=window.Slang||{},window.Slang._mathslang=window.Slang._mathslang||{},window.Slang._mathslang.semantix=function(){function n(n,t,e){this.fact=void 0!==n?n:1,this.imag=void 0!==t?t:{},this.sums=void 0!==e?e:[]}function t(n,t,e){this.offset=void 0!==n?n:0,this.queues=void 0!==t&&t.length?t:[],this.expont=void 0!==e?e:null}function e(){return Slang._mathslang.imaginary}function r(){return Slang._mathslang.syntax}function a(n){if("string"!=typeof n)throw"`Seman.present(string)' got `"+typeof n+"' instead of `string'";var t=r().present(n);return i(t)}function i(r){var a=new t;return r.forEach(function(r){var s=new n;s.fact=r.fact?r.fact.reduce(function(n,t){return n*t},1):1,s.imag=e().strParse(r.imag),r.exps.forEach(function(e){var r=i(e.radix),a=i(e.power),u=r.expont;if(r.expont=a,u){var o=new t;r.expont=u,o.expont=a,o.queues.push(new n(1,{},[r])),r=o}s.sums.push(r)}),r.sums.forEach(function(n){var t=i(n);s.sums.push(t)}),u(s)?a.offset+=s.fact:a.queues.push(s)}),a=a.solidify()}function u(n){return 0==e().len(n.imag)&&0==n.sums.length}function s(n){return Object.keys(n.imag).length>0?NaN:n.fact*n.sums.reduce(function(n,t){return n*t.calc()},1)}function o(t){var r=new n;return r.fact=t.fact,r.imag=e().clone(t.imag),r.sums=t.sums.map(function(n){return n.clone()}),r}function c(r,a){if(null!=r.expont)throw"`expansion': `s0.expont != null'";if(null!=a.expont)throw"`expansion': `s1.expont != null'";var i=r.offset*a.offset,u=r.queues.map(function(t){return new n(a.offset*t.fact,e().clone(t.imag),t.sums)}).concat(a.queues.map(function(t){return new n(r.offset*t.fact,e().clone(t.imag),t.sums)}));return r.queues.forEach(function(t){a.queues.forEach(function(r){var a={};e().insert(a,t.imag),e().insert(a,r.imag),u.push(new n(t.fact*r.fact,e().sort(a),t.sums.concat(r.sums)))})}),r=new t(i,u.filter(function(n){return 0!=n.fact}))}function f(n){var t,e,r,a=[];t=n.sums.reduce(function(n,t,e){t=t.combine(t);var r=t.expont;t.expont=null;var a=t.string();return t.expont=r,n[a]?n[a].push(e):n[a]=[e],n},new Object),e=Object.keys(t);for(var i=0;i<e.length;i++)r=t[e[i]],r.length>1&&(a=a.concat(l(n.sums,r)));return a.sort(function(n,t){return t-n}).forEach(function(t){n.sums.splice(t,1)}),n}function l(e,r){if(r.length<2)throw"`combineE': "+r.length+"/2 indices";var a=[],i=new t,u=new t;for(u.offset=e[r[0]].offset,u.queues=e[r[0]].queues;r.length;){var s=e[r[0]].expont;s?s.expont?i.queues.push(new n(1,{},[s])):(i.offset+=s.offset,i.queues=i.queues.concat(s.queues)):i.offset++,a.push(r[0]),r.splice(0,1)}return u.expont=i,e.push(u),a}function g(n){for(var t="",e=0;e<n.queues.length;++e){var r=n.queues[e];t=Object.keys(r.imag).reduce(function(n,t){var e=r.imag[t];return n+(1==e?t:-1==e?"1/"+t:t+"^"+e)},t),r.sums.forEach(function(n){t+="("+g(n)+")"}),e+1<n.queues.length&&(t+=" + ")}return n.expont?t+"^"+g(n.expont):t}return n.prototype.ident=function(){return this.fact*this.sums.reduce(function(n,t){return n*t.calc()},1)==1&&e().empty(this.imag)},n.prototype.string=function(){return this.sums.reduce(function(n,t){return n+"("+t.string()+")"},""+this.fact+e().string(this.imag))},n.prototype.pow=function(t){return new n(Math.pow(this.fact,t),Object.keys(this.imag).reduce(function(n,e){return n[e]=this.imag[e]*t,n},{}))},n.prototype.extract=function(){for(var r=this,a=new t(0,[new n(r.fact,e().clone(r.imag))]),i=0;i<r.sums.length;)r.sums[i].expand(),null==r.sums[i].expont?(a=c(a,r.sums[i]),r.sums.splice(i,1)):i++;return a},t.prototype.calc=function(){var n=this.offset+this.queues.reduce(function(n,t){return n+s(t)},0);return this.expont?Math.pow(n,this.expont.calc()):n},t.prototype.expand=function(){for(var n=0;n<this.queues.length;){var t=this.queues[n].extract();if(e().clear(this.queues[n].imag),this.queues[n].fact=1,this.queues[n].ident()){if(t.expont)throw"`expand': `s0.expont' must be `null'.";this.queues.splice(n,1),this.offset+=t.offset,this.queues=t.queues.concat(this.queues),n+=t.queues.length}else 1!=t.calc()&&this.queues[n].sums.push(t),++n}return this},t.prototype.combine=function(){var n=this.offset,r=[],a=void 0,i=this.expont;return i&&(i=this.expont.combine()),this.queues.filter(function(t){var e=s(t);return isNaN(e)?!0:(n+=e,!1)}).map(f).sort(function(n,t){return-e().sortFunc(n.imag,t.imag)}).forEach(function(n){void 0!=a&&e().equals(a.imag,n.imag)&&0==a.sums.length&&0==n.sums.length?r[0].fact+=n.fact:(r.unshift(n),a=n)}),r=r.filter(function(n){return 0!=n.fact}),new t(n,r,i).solidify()},t.prototype.string=function(){var n=this.expont?!0:!1;return this.queues.reduce(function(n,t){var e=t.string();return n+(t.fact<0?e:"+"+e)},(n?"(":"")+this.offset)+(n?")^("+this.expont.string()+")":"")},t.prototype.simplify=function(n){var t=this;do t=t.expand(),t=t.combine(),t=t.expow();while(--n>0);return t},t.prototype.expow=function(){function r(n){if(0==n.offset&&1==n.queues.length&&n.expont){for(var r=n.expont,a=n.queues[0],n=new t(0,[a]),i=0;i<a.sums.length;i++)a.sums[i].expont=c(a.sums[i].expont,r.clone());var u=r.calc();isNaN(u)?(a.sums.push(new t(a.fact,a.imag,r.clone())),a.fact=1,a.imag={}):(a.fact=Math.pow(a.fact,u),e().pow(a.imag,u))}return n}var a=r(this),i=a.expont?a.expont.calc():NaN;if(isNaN(i))a.expont&&a.expont.expont;else{for(var u=[];i>1;){var s=new t;s.offset=a.offset,s.queues=a.queues.map(o),u.push(s),i--}a.expont=1==i?null:new t(i),u.length&&(u.unshift(a),a=new t,a.queues.push(new n(1,{},u)))}return a.queues.forEach(function(n){n.sums=n.sums.map(function(n){return n.expow()})}),a=a.solidify()},t.prototype.solidify=function(){var n=this,t=n.expont?n.expont.calc():NaN;return 0!=n.offset||1!=n.queues.length||1!=n.queues[0].fact||0!=n.queues[0].sums||isNaN(t)?n.queues.forEach(function(n){return n.sums.map(function(n){return n.solidify()})}):(e().pow(n.queues[0].imag,t),n.expont=null),0!=n.offset||1!=n.queues.length||n.expont||1!=n.queues[0].fact||0!=e().len(n.queues[0].imag)||1!=n.queues[0].sums.length?n:n.queues[0].sums[0].solidify()},t.prototype.clone=function(){var n=this,e=new t;return e.offset=n.offset,e.queues=n.queues.map(o),e.expont=n.expont?n.expont.clone():null,e},t.prototype.free_const=function(){var n=this;n.offset=0,n.queues.forEach(function(n){n.fact=1,n.sums.forEach(function(n){n.free_const()})}),n.expont&&n.expont.free_const()},t.prototype.free_imag=function(){this.queues.forEach(function(n){n.imag="",n.sums.forEach(function(n){n.free_imag()})}),this.expont&&this.expont.free_imag()},{present:a,represent:i,unit:g}}(),window.Slang=window.Slang||{},window.Slang._mathslang=window.Slang._mathslang||{},window.Slang._mathslang.syntax=function(){function n(){this.fact=[],this.imag="",this.exps=[],this.sums=[]}function t(){this.radix=[],this.power=[]}function e(){return Slang._mathslang.lexical}function r(n){if("string"!=typeof n)throw"syntax.present(typeof s = "+typeof n+")";var t=e().iter(n),r=[];do{for(var i=!1;t.length>0&&t[0].flag==e().FLAG.O;)t.shift().inv&&(i=!i);var u=a(t);u&&(i&&u.fact.unshift(-1),r.push(u))}while(t.length>0);return c(r),r}function a(a){for(var o=new n;a.length>0;)switch(a[0].flag){case e().FLAG.N:var c=parseFloat(a[0].code);if(a.shift().inv){if(0==c)throw"`pluckQ' divided by 0.";c=1/c}o.fact.push(c);break;case e().FLAG.X:var f=a[0].code;if(a.shift().inv){var l=new t;l.radix.push(s(f)),l.power.push(u(-1)),o.exps.push(l)}else o.imag+=f;break;case e().FLAG.E:var l=new t;a[0].inv,l.radix=r(a.shift().code),l.power=i(a),o.exps.push(l);break;case e().FLAG.L:var g=r(a[0].code);if(a.shift().inv){var l=new t;l.radix=g,l.power.push(u(-1)),o.exps.push(l)}else o.sums.push(g);break;case e().FLAG.O:default:return p(o)?null:o}return p(o)?null:o}function i(n){if(!(n.length>0))throw"`pluckT' without any token.";switch(n[0].flag){case e().FLAG.N:return[u(n.shift().code)];case e().FLAG.X:return[s(n.shift().code)];case e().FLAG.E:var a=new t;if(n[0].inv)throw"`pluckT("+n[0].code+"..)' illegal `inv'";return a.radix=r(n.shift().code),a.power=i(n,!0),[o(a)];case e().FLAG.L:return r(n.shift().code);case e().FLAG.O:n.shift();var c=i(n);return c.forEach(function(n){n.fact.push(-1)}),c;default:throw"`pluckT' invalid `flag=?'."}}function u(t){var e=new n;return e.fact.push(t),e}function s(t){var e=new n;return"string"!=typeof t?e:(e.imag=t,e)}function o(t){var e=new n;return"E"!=typeof t?e:(e.exps.push(t),e)}function c(n){n.forEach(function(n){f(n)}),n.sort(function(n,t){return Slang._mathslang.imaginary.strSortFunc(n.imag,t.imag)})}function f(n){n.sums.forEach(function(n){c(n)}),n.fact.sort(function(n,t){return n-t}),n.imag=Slang._mathslang.imaginary.strSort(n.imag),n.exps.sort(function(n,t){return g(n)-g(t)}),n.sums.sort(function(n,t){return l(n)-l(t)})}function l(n){return n.reduce(function(n,t){return n+h(t)},0)}function g(n){return Math.pow(16536421.3572347+l(n.radix),l(n.power))}function h(n){return n.fact.reduce(function(n,t){return n*t},1)*Slang._mathslang.imaginary.strValue(n.imag)*n.exps.reduce(function(n,t){return n*g(t)},1)*n.sums.reduce(function(n,t){return n*l(t)},1)}function p(n){return 0==n.fact.length&&0==n.imag.length&&0==n.exps.length&&0==n.sums.length}function m(n){var t="";if(n.length){t+=w(n[0]);for(var e=1;e<n.length;e++){var r=n[e].fact.reduce(function(n,t){return n*t},1),a=w(n[e]);t+=0>r?a:"+"+a}}return t}function w(n){var t="";if(n.fact.length){t+=n.fact[0];for(var e=1;e<n.fact.length;e++)t+="*"+n.fact[e]}return t+=n.imag,t+=n.exps.reduce(function(n,t){return n+d(t)},""),t+=n.sums.reduce(function(n,t){return n+"("+m(t)+")"},"")}function d(n){return"("+m(n.radix)+")^("+m(n.power)+")"}return{Q:n,E:t,present:r,pluckQ:a,N2Q:u,X2Q:s,sort:c,emptyQ:p,string:m,stringQ:w}}();